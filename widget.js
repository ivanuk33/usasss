(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["io"]=factory();else root["io"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var url=__webpack_require__(1);var parser=__webpack_require__(7);var Manager=__webpack_require__(17);var debug=__webpack_require__(3)("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};function lookup(uri,opts){if((typeof uri==="undefined"?"undefined":_typeof(uri))==="object"){opts=uri;uri=undefined}opts=opts||{};var parsed=url(uri);var source=parsed.source;var id=parsed.id;var path=parsed.path;var sameNamespace=cache[id]&&path in cache[id].nsps;var newConnection=opts.forceNew||opts["force new connection"]||false===opts.multiplex||sameNamespace;var io;if(newConnection){debug("ignoring socket cache for %s",source);io=Manager(source,opts)}else{if(!cache[id]){debug("new io instance for %s",source);cache[id]=Manager(source,opts)}io=cache[id]}if(parsed.query&&!opts.query){opts.query=parsed.query}else if(opts&&"object"===_typeof(opts.query)){opts.query=encodeQueryString(opts.query)}return io.socket(parsed.path,opts)}function encodeQueryString(obj){var str=[];for(var p in obj){if(obj.hasOwnProperty(p)){str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]))}}return str.join("&")}exports.protocol=parser.protocol;exports.connect=lookup;exports.Manager=__webpack_require__(17);exports.Socket=__webpack_require__(44)},function(module,exports,__webpack_require__){(function(global){"use strict";var parseuri=__webpack_require__(2);var debug=__webpack_require__(3)("socket.io-client:url");module.exports=url;function url(uri,loc){var obj=uri;loc=loc||global.location;if(null==uri)uri=loc.protocol+"//"+loc.host;if("string"===typeof uri){if("/"===uri.charAt(0)){if("/"===uri.charAt(1)){uri=loc.protocol+uri}else{uri=loc.host+uri}}if(!/^(https?|wss?):\/\//.test(uri)){debug("protocol-less url %s",uri);if("undefined"!==typeof loc){uri=loc.protocol+"//"+uri}else{uri="https://"+uri}}debug("parse %s",uri);obj=parseuri(uri)}if(!obj.port){if(/^(http|ws)$/.test(obj.protocol)){obj.port="80"}else if(/^(http|ws)s$/.test(obj.protocol)){obj.port="443"}}obj.path=obj.path||"/";var ipv6=obj.host.indexOf(":")!==-1;var host=ipv6?"["+obj.host+"]":obj.host;obj.id=obj.protocol+"://"+host+":"+obj.port;obj.href=obj.protocol+"://"+host+(loc&&loc.port===obj.port?"":":"+obj.port);return obj}}).call(exports,function(){return this}())},function(module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function parseuri(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");if(b!=-1&&e!=-1){str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length)}var m=re.exec(str||""),uri={},i=14;while(i--){uri[parts[i]]=m[i]||""}if(b!=-1&&e!=-1){uri.source=src;uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":");uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":");uri.ipv6uri=true}return uri}},function(module,exports,__webpack_require__){(function(process){exports=module.exports=__webpack_require__(5);exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function useColors(){return typeof document!=="undefined"&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}exports.formatters.j=function(v){try{return JSON.stringify(v)}catch(err){return"[UnexpectedJSONParseError]: "+err.message}};function formatArgs(){var args=arguments;var useColors=this.useColors;args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff);if(!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0;var lastC=0;args[0].replace(/%[a-z%]/g,function(match){if("%%"===match)return;index++;if("%c"===match){lastC=index}});args.splice(lastC,0,c);return args}function log(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{if(null==namespaces){exports.storage.removeItem("debug")}else{exports.storage.debug=namespaces}}catch(e){}}function load(){var r;try{return exports.storage.debug}catch(e){}if(typeof process!=="undefined"&&"env"in process){return process.env.DEBUG}}exports.enable(load());function localstorage(){try{return window.localStorage}catch(e){}}}).call(exports,__webpack_require__(4))},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},function(module,exports,__webpack_require__){exports=module.exports=debug.debug=debug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=__webpack_require__(6);exports.names=[];exports.skips=[];exports.formatters={};var prevColor=0;var prevTime;function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}disabled.enabled=false;function enabled(){var self=enabled;var curr=+new Date;var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;if(null==self.useColors)self.useColors=exports.useColors();if(null==self.color&&self.useColors)self.color=selectColor();var args=new Array(arguments.length);for(var i=0;i<args.length;i++){args[i]=arguments[i]}args[0]=exports.coerce(args[0]);if("string"!==typeof args[0]){args=["%o"].concat(args)}var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if(match==="%%")return match;index++;var formatter=exports.formatters[format];if("function"===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}return match});args=exports.formatArgs.apply(self,args);var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}enabled.enabled=true;var fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;return fn}function enable(namespaces){exports.save(namespaces);var split=(namespaces||"").split(/[\s,]+/);var len=split.length;for(var i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?");if(namespaces[0]==="-"){exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$"))}else{exports.names.push(new RegExp("^"+namespaces+"$"))}}}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return false}}for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return true}}return false}function coerce(val){if(val instanceof Error)return val.stack||val.message;return val}},function(module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};var type=typeof val;if(type==="string"&&val.length>0){return parse(val)}else if(type==="number"&&isNaN(val)===false){return options.long?fmtLong(val):fmtShort(val)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))};function parse(str){str=String(str);if(str.length>1e4){return}var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match){return}var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return undefined}}function fmtShort(ms){if(ms>=d){return Math.round(ms/d)+"d"}if(ms>=h){return Math.round(ms/h)+"h"}if(ms>=m){return Math.round(ms/m)+"m"}if(ms>=s){return Math.round(ms/s)+"s"}return ms+"ms"}function fmtLong(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){if(ms<n){return}if(ms<n*1.5){return Math.floor(ms/n)+" "+name}return Math.ceil(ms/n)+" "+name+"s"}},function(module,exports,__webpack_require__){var debug=__webpack_require__(8)("socket.io-parser");var json=__webpack_require__(11);var Emitter=__webpack_require__(13);var binary=__webpack_require__(14);var isBuf=__webpack_require__(16);exports.protocol=4;exports.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"];exports.CONNECT=0;exports.DISCONNECT=1;exports.EVENT=2;exports.ACK=3;exports.ERROR=4;exports.BINARY_EVENT=5;exports.BINARY_ACK=6;exports.Encoder=Encoder;exports.Decoder=Decoder;function Encoder(){}Encoder.prototype.encode=function(obj,callback){debug("encoding packet %j",obj);if(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){encodeAsBinary(obj,callback)}else{var encoding=encodeAsString(obj);callback([encoding])}};function encodeAsString(obj){var str="";var nsp=false;str+=obj.type;if(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){str+=obj.attachments;str+="-"}if(obj.nsp&&"/"!=obj.nsp){nsp=true;str+=obj.nsp}if(null!=obj.id){if(nsp){str+=",";nsp=false}str+=obj.id}if(null!=obj.data){if(nsp)str+=",";str+=json.stringify(obj.data)}debug("encoded %j as %s",obj,str);return str}function encodeAsBinary(obj,callback){function writeEncoding(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData);var pack=encodeAsString(deconstruction.packet);var buffers=deconstruction.buffers;buffers.unshift(pack);callback(buffers)}binary.removeBlobs(obj,writeEncoding)}function Decoder(){this.reconstructor=null}Emitter(Decoder.prototype);Decoder.prototype.add=function(obj){var packet;if("string"==typeof obj){packet=decodeString(obj);if(exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type){this.reconstructor=new BinaryReconstructor(packet);if(this.reconstructor.reconPack.attachments===0){this.emit("decoded",packet)}}else{this.emit("decoded",packet)}}else if(isBuf(obj)||obj.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{packet=this.reconstructor.takeBinaryData(obj);if(packet){this.reconstructor=null;this.emit("decoded",packet)}}}else{throw new Error("Unknown type: "+obj)}};function decodeString(str){var p={};var i=0;p.type=Number(str.charAt(0));if(null==exports.types[p.type])return error();if(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){var buf="";while(str.charAt(++i)!="-"){buf+=str.charAt(i);if(i==str.length)break}if(buf!=Number(buf)||str.charAt(i)!="-"){throw new Error("Illegal attachments")}p.attachments=Number(buf)}if("/"==str.charAt(i+1)){p.nsp="";while(++i){var c=str.charAt(i);if(","==c)break;p.nsp+=c;if(i==str.length)break}}else{p.nsp="/"}var next=str.charAt(i+1);if(""!==next&&Number(next)==next){p.id="";while(++i){var c=str.charAt(i);if(null==c||Number(c)!=c){--i;break}p.id+=str.charAt(i);if(i==str.length)break}p.id=Number(p.id)}if(str.charAt(++i)){p=tryParse(p,str.substr(i))}debug("decoded %s as %j",str,p);return p}function tryParse(p,str){try{p.data=json.parse(str)}catch(e){return error()}return p}Decoder.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}};function BinaryReconstructor(packet){this.reconPack=packet;this.buffers=[]}BinaryReconstructor.prototype.takeBinaryData=function(binData){this.buffers.push(binData);if(this.buffers.length==this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return packet}return null};BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};function error(data){return{type:exports.ERROR,data:"parser error"}}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(9);exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:localstorage();exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}exports.formatters.j=function(v){return JSON.stringify(v)};function formatArgs(){var args=arguments;var useColors=this.useColors;args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff);if(!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0;var lastC=0;args[0].replace(/%[a-z%]/g,function(match){if("%%"===match)return;index++;if("%c"===match){lastC=index}});args.splice(lastC,0,c);return args}function log(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{if(null==namespaces){exports.storage.removeItem("debug")}else{exports.storage.debug=namespaces}}catch(e){}}function load(){var r;try{r=exports.storage.debug}catch(e){}return r}exports.enable(load());function localstorage(){try{return window.localStorage}catch(e){}}},function(module,exports,__webpack_require__){exports=module.exports=debug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=__webpack_require__(10);exports.names=[];exports.skips=[];exports.formatters={};var prevColor=0;var prevTime;function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}disabled.enabled=false;function enabled(){var self=enabled;var curr=+new Date;var ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;if(null==self.useColors)self.useColors=exports.useColors();if(null==self.color&&self.useColors)self.color=selectColor();var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]);if("string"!==typeof args[0]){args=["%o"].concat(args)}var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if(match==="%%")return match;index++;var formatter=exports.formatters[format];if("function"===typeof formatter){var val=args[index];match=formatter.call(self,val);args.splice(index,1);index--}return match});if("function"===typeof exports.formatArgs){args=exports.formatArgs.apply(self,args)}var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}enabled.enabled=true;var fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;return fn}function enable(namespaces){exports.save(namespaces);var split=(namespaces||"").split(/[\s,]+/);var len=split.length;for(var i=0;i<len;i++){if(!split[i])continue;namespaces=split[i].replace(/\*/g,".*?");if(namespaces[0]==="-"){exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$"))}else{exports.names.push(new RegExp("^"+namespaces+"$"))}}}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++){if(exports.skips[i].test(name)){return false}}for(i=0,len=exports.names.length;i<len;i++){if(exports.names[i].test(name)){return true}}return false}function coerce(val){if(val instanceof Error)return val.stack||val.message;return val}},function(module,exports){var s=1e3;var m=s*60;var h=m*60;var d=h*24;var y=d*365.25;module.exports=function(val,options){options=options||{};if("string"==typeof val)return parse(val);return options.long?long(val):short(val)};function parse(str){str=""+str;if(str.length>1e4)return;var match=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);var type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}function short(ms){if(ms>=d)return Math.round(ms/d)+"d";if(ms>=h)return Math.round(ms/h)+"h";if(ms>=m)return Math.round(ms/m)+"m";if(ms>=s)return Math.round(ms/s)+"s";return ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){if(ms<n)return;if(ms<n*1.5)return Math.floor(ms/n)+" "+name;return Math.ceil(ms/n)+" "+name+"s"}},function(module,exports,__webpack_require__){(function(module,global){var define=false;(function(){var isLoader=typeof define==="function"&&define.amd;var objectTypes={"function":true,object:true};var freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports;var root=objectTypes[typeof window]&&window||this,freeGlobal=freeExports&&objectTypes[typeof module]&&module&&!module.nodeType&&typeof global=="object"&&global;if(freeGlobal&&(freeGlobal["global"]===freeGlobal||freeGlobal["window"]===freeGlobal||freeGlobal["self"]===freeGlobal)){root=freeGlobal}function runInContext(context,exports){context||(context=root["Object"]());exports||(exports=root["Object"]());var Number=context["Number"]||root["Number"],String=context["String"]||root["String"],Object=context["Object"]||root["Object"],Date=context["Date"]||root["Date"],SyntaxError=context["SyntaxError"]||root["SyntaxError"],TypeError=context["TypeError"]||root["TypeError"],Math=context["Math"]||root["Math"],nativeJSON=context["JSON"]||root["JSON"];if(typeof nativeJSON=="object"&&nativeJSON){exports.stringify=nativeJSON.stringify;exports.parse=nativeJSON.parse}var objectProto=Object.prototype,getClass=objectProto.toString,isProperty,forEach,undef;var isExtended=new Date(-0xc782b5b800cec);try{isExtended=isExtended.getUTCFullYear()==-109252&&isExtended.getUTCMonth()===0&&isExtended.getUTCDate()===1&&isExtended.getUTCHours()==10&&isExtended.getUTCMinutes()==37&&isExtended.getUTCSeconds()==6&&isExtended.getUTCMilliseconds()==708}catch(exception){}function has(name){if(has[name]!==undef){return has[name]}var isSupported;if(name=="bug-string-char-index"){isSupported="a"[0]!="a"}else if(name=="json"){isSupported=has("json-stringify")&&has("json-parse")}else{var value,serialized='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(name=="json-stringify"){var stringify=exports.stringify,stringifySupported=typeof stringify=="function"&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported=stringify(0)==="0"&&stringify(new Number)==="0"&&stringify(new String)=='""'&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&stringify(value)==="1"&&stringify([value])=="[1]"&&stringify([undef])=="[null]"&&stringify(null)=="null"&&stringify([undef,getClass,null])=="[null,null,null]"&&stringify({a:[value,true,false,null,"\x00\b\n\f\r	"]})==serialized&&stringify(null,value)==="1"&&stringify([1,2],null,1)=="[\n 1,\n 2\n]"&&stringify(new Date(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&stringify(new Date(864e13))=='"+275760-09-13T00:00:00.000Z"'&&stringify(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&stringify(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(exception){stringifySupported=false}}isSupported=stringifySupported}if(name=="json-parse"){var parse=exports.parse;if(typeof parse=="function"){try{if(parse("0")===0&&!parse(false)){value=parse(serialized);var parseSupported=value["a"].length==5&&value["a"][0]===1;if(parseSupported){try{parseSupported=!parse('"	"')}catch(exception){}if(parseSupported){try{parseSupported=parse("01")!==1}catch(exception){}}if(parseSupported){try{parseSupported=parse("1.")!==1}catch(exception){}}}}}catch(exception){parseSupported=false}}isSupported=parseSupported}}return has[name]=!!isSupported}if(!has("json")){var functionClass="[object Function]",dateClass="[object Date]",numberClass="[object Number]",stringClass="[object String]",arrayClass="[object Array]",booleanClass="[object Boolean]";var charIndexBuggy=has("bug-string-char-index");if(!isExtended){var floor=Math.floor;var Months=[0,31,59,90,120,151,181,212,243,273,304,334];var getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(month>1)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)}}if(!(isProperty=objectProto.hasOwnProperty)){isProperty=function(property){var members={},constructor;if((members.__proto__=null,members.__proto__={toString:1},members).toString!=getClass){isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);this.__proto__=original;return result}}else{constructor=members.constructor;isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}}members=null;return isProperty.call(this,property)}}forEach=function(object,callback){var size=0,Properties,members,property;(Properties=function(){this.valueOf=0}).prototype.valueOf=0;members=new Properties;for(property in members){if(isProperty.call(members,property)){size++}}Properties=members=null;if(!size){members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,length;var hasProperty=!isFunction&&typeof object.constructor!="function"&&objectTypes[typeof object.hasOwnProperty]&&object.hasOwnProperty||isProperty;for(property in object){if(!(isFunction&&property=="prototype")&&hasProperty.call(object,property)){callback(property)}}for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}}else if(size==2){forEach=function(object,callback){var members={},isFunction=getClass.call(object)==functionClass,property;for(property in object){if(!(isFunction&&property=="prototype")&&!isProperty.call(members,property)&&(members[property]=1)&&isProperty.call(object,property)){callback(property)}}}}else{forEach=function(object,callback){var isFunction=getClass.call(object)==functionClass,property,isConstructor;for(property in object){if(!(isFunction&&property=="prototype")&&isProperty.call(object,property)&&!(isConstructor=property==="constructor")){callback(property)}}if(isConstructor||isProperty.call(object,property="constructor")){callback(property)}}}return forEach(object,callback)};if(!has("json-stringify")){var Escapes={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"};var leadingZeroes="000000";var toPaddedString=function(width,value){return(leadingZeroes+(value||0)).slice(-width)};var unicodePrefix="\\u00";var quote=function(value){var result='"',index=0,length=value.length,useCharIndex=!charIndexBuggy||length>10;var symbols=useCharIndex&&(charIndexBuggy?value.split(""):value);for(;index<length;index++){var charCode=value.charCodeAt(index);switch(charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(charCode<32){result+=unicodePrefix+toPaddedString(2,charCode.toString(16));break}result+=useCharIndex?symbols[index]:value.charAt(index)}}return result+'"'};var serialize=function(property,object,callback,properties,whitespace,indentation,stack){var value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;try{value=object[property]}catch(exception){}if(typeof value=="object"&&value){className=getClass.call(value);if(className==dateClass&&!isProperty.call(value,"toJSON")){if(value>-1/0&&value<1/0){if(getDay){date=floor(value/864e5);for(year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month);time=(value%864e5+864e5)%864e5;hours=floor(time/36e5)%24;minutes=floor(time/6e4)%60;seconds=floor(time/1e3)%60;milliseconds=time%1e3}else{year=value.getUTCFullYear();month=value.getUTCMonth();date=value.getUTCDate();hours=value.getUTCHours();minutes=value.getUTCMinutes();seconds=value.getUTCSeconds();milliseconds=value.getUTCMilliseconds()}value=(year<=0||year>=1e4?(year<0?"-":"+")+toPaddedString(6,year<0?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else{value=null}}else if(typeof value.toJSON=="function"&&(className!=numberClass&&className!=stringClass&&className!=arrayClass||isProperty.call(value,"toJSON"))){value=value.toJSON(property)}}if(callback){value=callback.call(object,property,value)}if(value===null){return"null"}className=getClass.call(value);if(className==booleanClass){return""+value}else if(className==numberClass){return value>-1/0&&value<1/0?""+value:"null"}else if(className==stringClass){return quote(""+value)}if(typeof value=="object"){for(length=stack.length;length--;){if(stack[length]===value){throw TypeError()}}stack.push(value);results=[];prefix=indentation;indentation+=whitespace;if(className==arrayClass){for(index=0,length=value.length;index<length;index++){element=serialize(index,value,callback,properties,whitespace,indentation,stack);results.push(element===undef?"null":element)}result=results.length?whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":"["+results.join(",")+"]":"[]"}else{forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);if(element!==undef){results.push(quote(property)+":"+(whitespace?" ":"")+element)}});result=results.length?whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":"{"+results.join(",")+"}":"{}"}stack.pop();return result}};exports.stringify=function(source,filter,width){var whitespace,callback,properties,className;if(objectTypes[typeof filter]&&filter){if((className=getClass.call(filter))==functionClass){callback=filter}else if(className==arrayClass){properties={};for(var index=0,length=filter.length,value;index<length;value=filter[index++],(className=getClass.call(value),className==stringClass||className==numberClass)&&(properties[value]=1));}}if(width){if((className=getClass.call(width))==numberClass){if((width-=width%1)>0){for(whitespace="",width>10&&(width=10);whitespace.length<width;whitespace+=" ");}}else if(className==stringClass){whitespace=width.length<=10?width:width.slice(0,10)}}return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}if(!has("json-parse")){var fromCharCode=String.fromCharCode;var Unescapes={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"};var Index,Source;var abort=function(){Index=Source=null;throw SyntaxError()};var lex=function(){var source=Source,length=source.length,value,begin,position,isSigned,charCode;while(Index<length){charCode=source.charCodeAt(Index);switch(charCode){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:value=charIndexBuggy?source.charAt(Index):source[Index];Index++;return value;case 34:for(value="@",Index++;Index<length;){charCode=source.charCodeAt(Index);if(charCode<32){abort()}else if(charCode==92){charCode=source.charCodeAt(++Index);switch(charCode){
case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode];Index++;break;case 117:begin=++Index;for(position=Index+4;Index<position;Index++){charCode=source.charCodeAt(Index);if(!(charCode>=48&&charCode<=57||charCode>=97&&charCode<=102||charCode>=65&&charCode<=70)){abort()}}value+=fromCharCode("0x"+source.slice(begin,Index));break;default:abort()}}else{if(charCode==34){break}charCode=source.charCodeAt(Index);begin=Index;while(charCode>=32&&charCode!=92&&charCode!=34){charCode=source.charCodeAt(++Index)}value+=source.slice(begin,Index)}}if(source.charCodeAt(Index)==34){Index++;return value}abort();default:begin=Index;if(charCode==45){isSigned=true;charCode=source.charCodeAt(++Index)}if(charCode>=48&&charCode<=57){if(charCode==48&&(charCode=source.charCodeAt(Index+1),charCode>=48&&charCode<=57)){abort()}isSigned=false;for(;Index<length&&(charCode=source.charCodeAt(Index),charCode>=48&&charCode<=57);Index++);if(source.charCodeAt(Index)==46){position=++Index;for(;position<length&&(charCode=source.charCodeAt(position),charCode>=48&&charCode<=57);position++);if(position==Index){abort()}Index=position}charCode=source.charCodeAt(Index);if(charCode==101||charCode==69){charCode=source.charCodeAt(++Index);if(charCode==43||charCode==45){Index++}for(position=Index;position<length&&(charCode=source.charCodeAt(position),charCode>=48&&charCode<=57);position++);if(position==Index){abort()}Index=position}return+source.slice(begin,Index)}if(isSigned){abort()}if(source.slice(Index,Index+4)=="true"){Index+=4;return true}else if(source.slice(Index,Index+5)=="false"){Index+=5;return false}else if(source.slice(Index,Index+4)=="null"){Index+=4;return null}abort()}}return"$"};var get=function(value){var results,hasMembers;if(value=="$"){abort()}if(typeof value=="string"){if((charIndexBuggy?value.charAt(0):value[0])=="@"){return value.slice(1)}if(value=="["){results=[];for(;;hasMembers||(hasMembers=true)){value=lex();if(value=="]"){break}if(hasMembers){if(value==","){value=lex();if(value=="]"){abort()}}else{abort()}}if(value==","){abort()}results.push(get(value))}return results}else if(value=="{"){results={};for(;;hasMembers||(hasMembers=true)){value=lex();if(value=="}"){break}if(hasMembers){if(value==","){value=lex();if(value=="}"){abort()}}else{abort()}}if(value==","||typeof value!="string"||(charIndexBuggy?value.charAt(0):value[0])!="@"||lex()!=":"){abort()}results[value.slice(1)]=get(lex())}return results}abort()}return value};var update=function(source,property,callback){var element=walk(source,property,callback);if(element===undef){delete source[property]}else{source[property]=element}};var walk=function(source,property,callback){var value=source[property],length;if(typeof value=="object"&&value){if(getClass.call(value)==arrayClass){for(length=value.length;length--;){update(value,length,callback)}}else{forEach(value,function(property){update(value,property,callback)})}}return callback.call(source,property,value)};exports.parse=function(source,callback){var result,value;Index=0;Source=""+source;result=get(lex());if(lex()!="$"){abort()}Index=Source=null;return callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}exports["runInContext"]=runInContext;return exports}if(freeExports&&!isLoader){runInContext(root,freeExports)}else{var nativeJSON=root.JSON,previousJSON=root["JSON3"],isRestored=false;var JSON3=runInContext(root,root["JSON3"]={noConflict:function(){if(!isRestored){isRestored=true;root.JSON=nativeJSON;root["JSON3"]=previousJSON;nativeJSON=previousJSON=null}return JSON3}});root.JSON={parse:JSON3.parse,stringify:JSON3.stringify}}if(isLoader){define(function(){return JSON3})}}).call(this)}).call(exports,__webpack_require__(12)(module),function(){return this}())},function(module,exports){module.exports=function(module){if(!module.webpackPolyfill){module.deprecate=function(){};module.paths=[];module.children=[];module.webpackPolyfill=1}return module}},function(module,exports){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks[event]=this._callbacks[event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){var self=this;this._callbacks=this._callbacks||{};function on(){self.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks[event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks[event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},function(module,exports,__webpack_require__){(function(global){var isArray=__webpack_require__(15);var isBuf=__webpack_require__(16);exports.deconstructPacket=function(packet){var buffers=[];var packetData=packet.data;function _deconstructPacket(data){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:true,num:buffers.length};buffers.push(data);return placeholder}else if(isArray(data)){var newData=new Array(data.length);for(var i=0;i<data.length;i++){newData[i]=_deconstructPacket(data[i])}return newData}else if("object"==typeof data&&!(data instanceof Date)){var newData={};for(var key in data){newData[key]=_deconstructPacket(data[key])}return newData}return data}var pack=packet;pack.data=_deconstructPacket(packetData);pack.attachments=buffers.length;return{packet:pack,buffers:buffers}};exports.reconstructPacket=function(packet,buffers){var curPlaceHolder=0;function _reconstructPacket(data){if(data&&data._placeholder){var buf=buffers[data.num];return buf}else if(isArray(data)){for(var i=0;i<data.length;i++){data[i]=_reconstructPacket(data[i])}return data}else if(data&&"object"==typeof data){for(var key in data){data[key]=_reconstructPacket(data[key])}return data}return data}packet.data=_reconstructPacket(packet.data);packet.attachments=undefined;return packet};exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if(global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){pendingBlobs++;var fileReader=new FileReader;fileReader.onload=function(){if(containingObject){containingObject[curKey]=this.result}else{bloblessData=this.result}if(!--pendingBlobs){callback(bloblessData)}};fileReader.readAsArrayBuffer(obj)}else if(isArray(obj)){for(var i=0;i<obj.length;i++){_removeBlobs(obj[i],i,obj)}}else if(obj&&"object"==typeof obj&&!isBuf(obj)){for(var key in obj){_removeBlobs(obj[key],key,obj)}}}var pendingBlobs=0;var bloblessData=data;_removeBlobs(bloblessData);if(!pendingBlobs){callback(bloblessData)}}}).call(exports,function(){return this}())},function(module,exports){module.exports=Array.isArray||function(arr){return Object.prototype.toString.call(arr)=="[object Array]"}},function(module,exports){(function(global){module.exports=isBuf;function isBuf(obj){return global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var eio=__webpack_require__(18);var Socket=__webpack_require__(44);var Emitter=__webpack_require__(35);var parser=__webpack_require__(7);var on=__webpack_require__(46);var bind=__webpack_require__(47);var debug=__webpack_require__(3)("socket.io-client:manager");var indexOf=__webpack_require__(42);var Backoff=__webpack_require__(48);var has=Object.prototype.hasOwnProperty;module.exports=Manager;function Manager(uri,opts){if(!(this instanceof Manager))return new Manager(uri,opts);if(uri&&"object"===(typeof uri==="undefined"?"undefined":_typeof(uri))){opts=uri;uri=undefined}opts=opts||{};opts.path=opts.path||"/socket.io";this.nsps={};this.subs=[];this.opts=opts;this.reconnection(opts.reconnection!==false);this.reconnectionAttempts(opts.reconnectionAttempts||Infinity);this.reconnectionDelay(opts.reconnectionDelay||1e3);this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3);this.randomizationFactor(opts.randomizationFactor||.5);this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==opts.timeout?2e4:opts.timeout);this.readyState="closed";this.uri=uri;this.connecting=[];this.lastPing=null;this.encoding=false;this.packetBuffer=[];this.encoder=new parser.Encoder;this.decoder=new parser.Decoder;this.autoConnect=opts.autoConnect!==false;if(this.autoConnect)this.open()}Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var nsp in this.nsps){if(has.call(this.nsps,nsp)){this.nsps[nsp].emit.apply(this.nsps[nsp],arguments)}}};Manager.prototype.updateSocketIds=function(){for(var nsp in this.nsps){if(has.call(this.nsps,nsp)){this.nsps[nsp].id=this.engine.id}}};Emitter(Manager.prototype);Manager.prototype.reconnection=function(v){if(!arguments.length)return this._reconnection;this._reconnection=!!v;return this};Manager.prototype.reconnectionAttempts=function(v){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=v;return this};Manager.prototype.reconnectionDelay=function(v){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=v;this.backoff&&this.backoff.setMin(v);return this};Manager.prototype.randomizationFactor=function(v){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=v;this.backoff&&this.backoff.setJitter(v);return this};Manager.prototype.reconnectionDelayMax=function(v){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=v;this.backoff&&this.backoff.setMax(v);return this};Manager.prototype.timeout=function(v){if(!arguments.length)return this._timeout;this._timeout=v;return this};Manager.prototype.maybeReconnectOnOpen=function(){if(!this.reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}};Manager.prototype.open=Manager.prototype.connect=function(fn,opts){debug("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri);this.engine=eio(this.uri,this.opts);var socket=this.engine;var self=this;this.readyState="opening";this.skipReconnect=false;var openSub=on(socket,"open",function(){self.onopen();fn&&fn()});var errorSub=on(socket,"error",function(data){debug("connect_error");self.cleanup();self.readyState="closed";self.emitAll("connect_error",data);if(fn){var err=new Error("Connection error");err.data=data;fn(err)}else{self.maybeReconnectOnOpen()}});if(false!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout);var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout);openSub.destroy();socket.close();socket.emit("error","timeout");self.emitAll("connect_timeout",timeout)},timeout);this.subs.push({destroy:function destroy(){clearTimeout(timer)}})}this.subs.push(openSub);this.subs.push(errorSub);return this};Manager.prototype.onopen=function(){debug("open");this.cleanup();this.readyState="open";this.emit("open");var socket=this.engine;this.subs.push(on(socket,"data",bind(this,"ondata")));this.subs.push(on(socket,"ping",bind(this,"onping")));this.subs.push(on(socket,"pong",bind(this,"onpong")));this.subs.push(on(socket,"error",bind(this,"onerror")));this.subs.push(on(socket,"close",bind(this,"onclose")));this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded")))};Manager.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};Manager.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};Manager.prototype.ondata=function(data){this.decoder.add(data)};Manager.prototype.ondecoded=function(packet){this.emit("packet",packet)};Manager.prototype.onerror=function(err){debug("error",err);this.emitAll("error",err)};Manager.prototype.socket=function(nsp,opts){var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp,opts);this.nsps[nsp]=socket;var self=this;socket.on("connecting",onConnecting);socket.on("connect",function(){socket.id=self.engine.id});if(this.autoConnect){onConnecting()}}function onConnecting(){if(!~indexOf(self.connecting,socket)){self.connecting.push(socket)}}return socket};Manager.prototype.destroy=function(socket){var index=indexOf(this.connecting,socket);if(~index)this.connecting.splice(index,1);if(this.connecting.length)return;this.close()};Manager.prototype.packet=function(packet){debug("writing packet %j",packet);var self=this;if(packet.query&&packet.type===0)packet.nsp+="?"+packet.query;if(!self.encoding){self.encoding=true;this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++){self.engine.write(encodedPackets[i],packet.options)}self.encoding=false;self.processPacketQueue()})}else{self.packetBuffer.push(packet)}};Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack)}};Manager.prototype.cleanup=function(){debug("cleanup");var subsLength=this.subs.length;for(var i=0;i<subsLength;i++){var sub=this.subs.shift();sub.destroy()}this.packetBuffer=[];this.encoding=false;this.lastPing=null;this.decoder.destroy()};Manager.prototype.close=Manager.prototype.disconnect=function(){debug("disconnect");this.skipReconnect=true;this.reconnecting=false;if("opening"===this.readyState){this.cleanup()}this.backoff.reset();this.readyState="closed";if(this.engine)this.engine.close()};Manager.prototype.onclose=function(reason){debug("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",reason);if(this._reconnection&&!this.skipReconnect){this.reconnect()}};Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts){debug("reconnect failed");this.backoff.reset();this.emitAll("reconnect_failed");this.reconnecting=false}else{var delay=this.backoff.duration();debug("will wait %dms before reconnect attempt",delay);this.reconnecting=true;var timer=setTimeout(function(){if(self.skipReconnect)return;debug("attempting reconnect");self.emitAll("reconnect_attempt",self.backoff.attempts);self.emitAll("reconnecting",self.backoff.attempts);if(self.skipReconnect)return;self.open(function(err){if(err){debug("reconnect attempt error");self.reconnecting=false;self.reconnect();self.emitAll("reconnect_error",err.data)}else{debug("reconnect success");self.onreconnect()}})},delay);this.subs.push({destroy:function destroy(){clearTimeout(timer)}})}};Manager.prototype.onreconnect=function(){var attempt=this.backoff.attempts;this.reconnecting=false;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",attempt)}},function(module,exports,__webpack_require__){module.exports=__webpack_require__(19)},function(module,exports,__webpack_require__){module.exports=__webpack_require__(20);module.exports.parser=__webpack_require__(27)},function(module,exports,__webpack_require__){(function(global){var transports=__webpack_require__(21);var Emitter=__webpack_require__(35);var debug=__webpack_require__(3)("engine.io-client:socket");var index=__webpack_require__(42);var parser=__webpack_require__(27);var parseuri=__webpack_require__(2);var parsejson=__webpack_require__(43);var parseqs=__webpack_require__(36);module.exports=Socket;function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);opts=opts||{};if(uri&&"object"===typeof uri){opts=uri;uri=null}if(uri){uri=parseuri(uri);opts.hostname=uri.host;opts.secure=uri.protocol==="https"||uri.protocol==="wss";opts.port=uri.port;if(uri.query)opts.query=uri.query}else if(opts.host){opts.hostname=parseuri(opts.host).host}this.secure=null!=opts.secure?opts.secure:global.location&&"https:"===location.protocol;if(opts.hostname&&!opts.port){opts.port=this.secure?"443":"80"}this.agent=opts.agent||false;this.hostname=opts.hostname||(global.location?location.hostname:"localhost");this.port=opts.port||(global.location&&location.port?location.port:this.secure?443:80);this.query=opts.query||{};if("string"===typeof this.query)this.query=parseqs.decode(this.query);this.upgrade=false!==opts.upgrade;this.path=(opts.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!opts.forceJSONP;this.jsonp=false!==opts.jsonp;this.forceBase64=!!opts.forceBase64;this.enablesXDR=!!opts.enablesXDR;this.timestampParam=opts.timestampParam||"t";this.timestampRequests=opts.timestampRequests;this.transports=opts.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=opts.policyPort||843;this.rememberUpgrade=opts.rememberUpgrade||false;this.binaryType=null;this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades;this.perMessageDeflate=false!==opts.perMessageDeflate?opts.perMessageDeflate||{}:false;if(true===this.perMessageDeflate)this.perMessageDeflate={};if(this.perMessageDeflate&&null==this.perMessageDeflate.threshold){this.perMessageDeflate.threshold=1024}this.pfx=opts.pfx||null;this.key=opts.key||null;this.passphrase=opts.passphrase||null;this.cert=opts.cert||null;this.ca=opts.ca||null;this.ciphers=opts.ciphers||null;this.rejectUnauthorized=opts.rejectUnauthorized===undefined?null:opts.rejectUnauthorized;this.forceNode=!!opts.forceNode;var freeGlobal=typeof global==="object"&&global;if(freeGlobal.global===freeGlobal){if(opts.extraHeaders&&Object.keys(opts.extraHeaders).length>0){this.extraHeaders=opts.extraHeaders}if(opts.localAddress){this.localAddress=opts.localAddress}}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingIntervalTimer=null;this.pingTimeoutTimer=null;this.open()}Socket.priorWebsocketSuccess=false;Emitter(Socket.prototype);Socket.protocol=parser.protocol;Socket.Socket=Socket;Socket.Transport=__webpack_require__(26);Socket.transports=__webpack_require__(21);Socket.parser=__webpack_require__(27);Socket.prototype.createTransport=function(name){debug('creating transport "%s"',name);var query=clone(this.query);query.EIO=parser.protocol;query.transport=name;if(this.id)query.sid=this.id;var transport=new transports[name]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:query,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return transport};function clone(obj){var o={};for(var i in obj){if(obj.hasOwnProperty(i)){o[i]=obj[i]}}return o}Socket.prototype.open=function(){var transport;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){transport="websocket"}else if(0===this.transports.length){var self=this;setTimeout(function(){self.emit("error","No transports available")},0);return}else{transport=this.transports[0]}this.readyState="opening";try{transport=this.createTransport(transport)}catch(e){this.transports.shift();this.open();return}transport.open();this.setTransport(transport)};Socket.prototype.setTransport=function(transport){debug("setting transport %s",transport.name);var self=this;if(this.transport){debug("clearing existing transport %s",this.transport.name);this.transport.removeAllListeners()}this.transport=transport;transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})};Socket.prototype.probe=function(name){debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1});var failed=false;var self=this;Socket.priorWebsocketSuccess=false;function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}if(failed)return;debug('probe transport "%s" opened',name);transport.send([{type:"ping",data:"probe"}]);transport.once("packet",function(msg){if(failed)return;if("pong"===msg.type&&"probe"===msg.data){debug('probe transport "%s" pong',name);self.upgrading=true;self.emit("upgrading",transport);if(!transport)return;Socket.priorWebsocketSuccess="websocket"===transport.name;debug('pausing current transport "%s"',self.transport.name);self.transport.pause(function(){if(failed)return;if("closed"===self.readyState)return;debug("changing transport and sending upgrade packet");cleanup();self.setTransport(transport);transport.send([{type:"upgrade"}]);self.emit("upgrade",transport);transport=null;self.upgrading=false;self.flush()})}else{debug('probe transport "%s" failed',name);var err=new Error("probe error");err.transport=transport.name;self.emit("upgradeError",err)}})}function freezeTransport(){if(failed)return;failed=true;cleanup();transport.close();transport=null}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name;freezeTransport();debug('probe transport "%s" failed because of error: %s',name,err);self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){if(transport&&to.name!==transport.name){debug('"%s" works - aborting "%s"',to.name,transport.name);freezeTransport()}}function cleanup(){transport.removeListener("open",onTransportOpen);transport.removeListener("error",onerror);transport.removeListener("close",onTransportClose);self.removeListener("close",onclose);self.removeListener("upgrading",onupgrade)}transport.once("open",onTransportOpen);transport.once("error",onerror);transport.once("close",onTransportClose);this.once("close",onclose);this.once("upgrading",onupgrade);transport.open()};Socket.prototype.onOpen=function(){debug("socket open");this.readyState="open";Socket.priorWebsocketSuccess="websocket"===this.transport.name;this.emit("open");this.flush();if("open"===this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;i<l;i++){this.probe(this.upgrades[i])}}};Socket.prototype.onPacket=function(packet){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){debug('socket receive: type "%s", data "%s"',packet.type,packet.data);this.emit("packet",packet);this.emit("heartbeat");switch(packet.type){case"open":this.onHandshake(parsejson(packet.data));break;case"pong":this.setPing();this.emit("pong");break;case"error":var err=new Error("server error");err.code=packet.data;this.onError(err);break;case"message":this.emit("data",packet.data);this.emit("message",packet.data);break}}else{debug('packet received with socket readyState "%s"',this.readyState)}};Socket.prototype.onHandshake=function(data){this.emit("handshake",data);this.id=data.sid;this.transport.query.sid=data.sid;this.upgrades=this.filterUpgrades(data.upgrades);this.pingInterval=data.pingInterval;this.pingTimeout=data.pingTimeout;this.onOpen();if("closed"===this.readyState)return;this.setPing();this.removeListener("heartbeat",this.onHeartbeat);this.on("heartbeat",this.onHeartbeat)};Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){if("closed"===self.readyState)return;self.onClose("ping timeout")},timeout||self.pingInterval+self.pingTimeout)};Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer);self.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",self.pingTimeout);self.ping();self.onHeartbeat(self.pingTimeout)},self.pingInterval)};Socket.prototype.ping=function(){var self=this;this.sendPacket("ping",function(){self.emit("ping")})};Socket.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emit("drain")}else{this.flush()}};Socket.prototype.flush=function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){debug("flushing %d packets in socket",this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit("flush")}};Socket.prototype.write=Socket.prototype.send=function(msg,options,fn){this.sendPacket("message",msg,options,fn);return this};Socket.prototype.sendPacket=function(type,data,options,fn){if("function"===typeof data){fn=data;data=undefined}if("function"===typeof options){fn=options;options=null}if("closing"===this.readyState||"closed"===this.readyState){return}options=options||{};options.compress=false!==options.compress;var packet={type:type,data:data,options:options};this.emit("packetCreate",packet);this.writeBuffer.push(packet);if(fn)this.once("flush",fn);this.flush()};Socket.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var self=this;if(this.writeBuffer.length){this.once("drain",function(){if(this.upgrading){waitForUpgrade()}else{close()}})}else if(this.upgrading){waitForUpgrade()}else{close()}}function close(){self.onClose("forced close");debug("socket closing - telling transport to close");self.transport.close()}function cleanupAndClose(){self.removeListener("upgrade",cleanupAndClose);self.removeListener("upgradeError",cleanupAndClose);close()}function waitForUpgrade(){self.once("upgrade",cleanupAndClose);self.once("upgradeError",cleanupAndClose)}return this};Socket.prototype.onError=function(err){debug("socket error %j",err);Socket.priorWebsocketSuccess=false;this.emit("error",err);this.onClose("transport error",err)};Socket.prototype.onClose=function(reason,desc){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){debug('socket close with reason: "%s"',reason);var self=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",reason,desc);self.writeBuffer=[];self.prevBufferLen=0}};Socket.prototype.filterUpgrades=function(upgrades){var filteredUpgrades=[];for(var i=0,j=upgrades.length;i<j;i++){if(~index(this.transports,upgrades[i]))filteredUpgrades.push(upgrades[i])}return filteredUpgrades}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){(function(global){var XMLHttpRequest=__webpack_require__(22);var XHR=__webpack_require__(24);var JSONP=__webpack_require__(39);var websocket=__webpack_require__(40);exports.polling=polling;exports.websocket=websocket;function polling(opts){var xhr;var xd=false;var xs=false;var jsonp=false!==opts.jsonp;if(global.location){var isSSL="https:"===location.protocol;var port=location.port;if(!port){port=isSSL?443:80}xd=opts.hostname!==location.hostname||port!==opts.port;xs=opts.secure!==isSSL}opts.xdomain=xd;opts.xscheme=xs;xhr=new XMLHttpRequest(opts);if("open"in xhr&&!opts.forceJSONP){return new XHR(opts)}else{if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)}}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){(function(global){var hasCORS=__webpack_require__(23);module.exports=function(opts){var xdomain=opts.xdomain;var xscheme=opts.xscheme;var enablesXDR=opts.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!xdomain||hasCORS)){return new XMLHttpRequest}}catch(e){}try{if("undefined"!==typeof XDomainRequest&&!xscheme&&enablesXDR){return new XDomainRequest}}catch(e){}if(!xdomain){try{return new(global[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}}).call(exports,function(){return this}())},function(module,exports){try{module.exports=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(err){module.exports=false}},function(module,exports,__webpack_require__){(function(global){var XMLHttpRequest=__webpack_require__(22);var Polling=__webpack_require__(25);var Emitter=__webpack_require__(35);var inherit=__webpack_require__(37);var debug=__webpack_require__(3)("engine.io-client:polling-xhr");module.exports=XHR;module.exports.Request=Request;function empty(){}function XHR(opts){Polling.call(this,opts);this.requestTimeout=opts.requestTimeout;if(global.location){var isSSL="https:"===location.protocol;var port=location.port;if(!port){port=isSSL?443:80}this.xd=opts.hostname!==global.location.hostname||port!==opts.port;this.xs=opts.secure!==isSSL}else{this.extraHeaders=opts.extraHeaders}}inherit(XHR,Polling);XHR.prototype.supportsBinary=true;XHR.prototype.request=function(opts){opts=opts||{};opts.uri=this.uri();opts.xd=this.xd;opts.xs=this.xs;opts.agent=this.agent||false;opts.supportsBinary=this.supportsBinary;opts.enablesXDR=this.enablesXDR;opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;opts.requestTimeout=this.requestTimeout;opts.extraHeaders=this.extraHeaders;return new Request(opts)};XHR.prototype.doWrite=function(data,fn){var isBinary=typeof data!=="string"&&data!==undefined;var req=this.request({method:"POST",data:data,isBinary:isBinary});var self=this;req.on("success",fn);req.on("error",function(err){self.onError("xhr post error",err)});this.sendXhr=req};XHR.prototype.doPoll=function(){debug("xhr poll");var req=this.request();var self=this;req.on("data",function(data){self.onData(data)});req.on("error",function(err){self.onError("xhr poll error",err)});this.pollXhr=req};function Request(opts){this.method=opts.method||"GET";this.uri=opts.uri;this.xd=!!opts.xd;this.xs=!!opts.xs;this.async=false!==opts.async;this.data=undefined!==opts.data?opts.data:null;this.agent=opts.agent;this.isBinary=opts.isBinary;this.supportsBinary=opts.supportsBinary;this.enablesXDR=opts.enablesXDR;this.requestTimeout=opts.requestTimeout;this.pfx=opts.pfx;this.key=opts.key;this.passphrase=opts.passphrase;this.cert=opts.cert;this.ca=opts.ca;this.ciphers=opts.ciphers;this.rejectUnauthorized=opts.rejectUnauthorized;this.extraHeaders=opts.extraHeaders;this.create()}Emitter(Request.prototype);Request.prototype.create=function(){var opts={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;var xhr=this.xhr=new XMLHttpRequest(opts);var self=this;try{debug("xhr open %s: %s",this.method,this.uri);xhr.open(this.method,this.uri,this.async);try{if(this.extraHeaders){xhr.setDisableHeaderCheck(true);
for(var i in this.extraHeaders){if(this.extraHeaders.hasOwnProperty(i)){xhr.setRequestHeader(i,this.extraHeaders[i])}}}}catch(e){}if(this.supportsBinary){xhr.responseType="arraybuffer"}if("POST"===this.method){try{if(this.isBinary){xhr.setRequestHeader("Content-type","application/octet-stream")}else{xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}}catch(e){}}try{xhr.setRequestHeader("Accept","*/*")}catch(e){}if("withCredentials"in xhr){xhr.withCredentials=true}if(this.requestTimeout){xhr.timeout=this.requestTimeout}if(this.hasXDR()){xhr.onload=function(){self.onLoad()};xhr.onerror=function(){self.onError(xhr.responseText)}}else{xhr.onreadystatechange=function(){if(4!==xhr.readyState)return;if(200===xhr.status||1223===xhr.status){self.onLoad()}else{setTimeout(function(){self.onError(xhr.status)},0)}}}debug("xhr data %s",this.data);xhr.send(this.data)}catch(e){setTimeout(function(){self.onError(e)},0);return}if(global.document){this.index=Request.requestsCount++;Request.requests[this.index]=this}};Request.prototype.onSuccess=function(){this.emit("success");this.cleanup()};Request.prototype.onData=function(data){this.emit("data",data);this.onSuccess()};Request.prototype.onError=function(err){this.emit("error",err);this.cleanup(true)};Request.prototype.cleanup=function(fromError){if("undefined"===typeof this.xhr||null===this.xhr){return}if(this.hasXDR()){this.xhr.onload=this.xhr.onerror=empty}else{this.xhr.onreadystatechange=empty}if(fromError){try{this.xhr.abort()}catch(e){}}if(global.document){delete Request.requests[this.index]}this.xhr=null};Request.prototype.onLoad=function(){var data;try{var contentType;try{contentType=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if(contentType==="application/octet-stream"){data=this.xhr.response||this.xhr.responseText}else{if(!this.supportsBinary){data=this.xhr.responseText}else{try{data=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(e){var ui8Arr=new Uint8Array(this.xhr.response);var dataArray=[];for(var idx=0,length=ui8Arr.length;idx<length;idx++){dataArray.push(ui8Arr[idx])}data=String.fromCharCode.apply(null,dataArray)}}}}catch(e){this.onError(e)}if(null!=data){this.onData(data)}};Request.prototype.hasXDR=function(){return"undefined"!==typeof global.XDomainRequest&&!this.xs&&this.enablesXDR};Request.prototype.abort=function(){this.cleanup()};Request.requestsCount=0;Request.requests={};if(global.document){if(global.attachEvent){global.attachEvent("onunload",unloadHandler)}else if(global.addEventListener){global.addEventListener("beforeunload",unloadHandler,false)}}function unloadHandler(){for(var i in Request.requests){if(Request.requests.hasOwnProperty(i)){Request.requests[i].abort()}}}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){var Transport=__webpack_require__(26);var parseqs=__webpack_require__(36);var parser=__webpack_require__(27);var inherit=__webpack_require__(37);var yeast=__webpack_require__(38);var debug=__webpack_require__(3)("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var XMLHttpRequest=__webpack_require__(22);var xhr=new XMLHttpRequest({xdomain:false});return null!=xhr.responseType}();function Polling(opts){var forceBase64=opts&&opts.forceBase64;if(!hasXHR2||forceBase64){this.supportsBinary=false}Transport.call(this,opts)}inherit(Polling,Transport);Polling.prototype.name="polling";Polling.prototype.doOpen=function(){this.poll()};Polling.prototype.pause=function(onPause){var self=this;this.readyState="pausing";function pause(){debug("paused");self.readyState="paused";onPause()}if(this.polling||!this.writable){var total=0;if(this.polling){debug("we are currently polling - waiting to pause");total++;this.once("pollComplete",function(){debug("pre-pause polling complete");--total||pause()})}if(!this.writable){debug("we are currently writing - waiting to pause");total++;this.once("drain",function(){debug("pre-pause writing complete");--total||pause()})}}else{pause()}};Polling.prototype.poll=function(){debug("polling");this.polling=true;this.doPoll();this.emit("poll")};Polling.prototype.onData=function(data){var self=this;debug("polling got data %s",data);var callback=function(packet,index,total){if("opening"===self.readyState){self.onOpen()}if("close"===packet.type){self.onClose();return false}self.onPacket(packet)};parser.decodePayload(data,this.socket.binaryType,callback);if("closed"!==this.readyState){this.polling=false;this.emit("pollComplete");if("open"===this.readyState){this.poll()}else{debug('ignoring poll - transport state "%s"',this.readyState)}}};Polling.prototype.doClose=function(){var self=this;function close(){debug("writing close packet");self.write([{type:"close"}])}if("open"===this.readyState){debug("transport open - closing");close()}else{debug("transport not open - deferring close");this.once("open",close)}};Polling.prototype.write=function(packets){var self=this;this.writable=false;var callbackfn=function(){self.writable=true;self.emit("drain")};parser.encodePayload(packets,this.supportsBinary,function(data){self.doWrite(data,callbackfn)})};Polling.prototype.uri=function(){var query=this.query||{};var schema=this.secure?"https":"http";var port="";if(false!==this.timestampRequests){query[this.timestampParam]=yeast()}if(!this.supportsBinary&&!query.sid){query.b64=1}query=parseqs.encode(query);if(this.port&&("https"===schema&&Number(this.port)!==443||"http"===schema&&Number(this.port)!==80)){port=":"+this.port}if(query.length){query="?"+query}var ipv6=this.hostname.indexOf(":")!==-1;return schema+"://"+(ipv6?"["+this.hostname+"]":this.hostname)+port+this.path+query}},function(module,exports,__webpack_require__){var parser=__webpack_require__(27);var Emitter=__webpack_require__(35);module.exports=Transport;function Transport(opts){this.path=opts.path;this.hostname=opts.hostname;this.port=opts.port;this.secure=opts.secure;this.query=opts.query;this.timestampParam=opts.timestampParam;this.timestampRequests=opts.timestampRequests;this.readyState="";this.agent=opts.agent||false;this.socket=opts.socket;this.enablesXDR=opts.enablesXDR;this.pfx=opts.pfx;this.key=opts.key;this.passphrase=opts.passphrase;this.cert=opts.cert;this.ca=opts.ca;this.ciphers=opts.ciphers;this.rejectUnauthorized=opts.rejectUnauthorized;this.forceNode=opts.forceNode;this.extraHeaders=opts.extraHeaders;this.localAddress=opts.localAddress}Emitter(Transport.prototype);Transport.prototype.onError=function(msg,desc){var err=new Error(msg);err.type="TransportError";err.description=desc;this.emit("error",err);return this};Transport.prototype.open=function(){if("closed"===this.readyState||""===this.readyState){this.readyState="opening";this.doOpen()}return this};Transport.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.doClose();this.onClose()}return this};Transport.prototype.send=function(packets){if("open"===this.readyState){this.write(packets)}else{throw new Error("Transport not open")}};Transport.prototype.onOpen=function(){this.readyState="open";this.writable=true;this.emit("open")};Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)};Transport.prototype.onPacket=function(packet){this.emit("packet",packet)};Transport.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(module,exports,__webpack_require__){(function(global){var keys=__webpack_require__(28);var hasBinary=__webpack_require__(29);var sliceBuffer=__webpack_require__(30);var after=__webpack_require__(31);var utf8=__webpack_require__(32);var base64encoder;if(global&&global.ArrayBuffer){base64encoder=__webpack_require__(33)}var isAndroid=typeof navigator!=="undefined"&&/Android/i.test(navigator.userAgent);var isPhantomJS=typeof navigator!=="undefined"&&/PhantomJS/i.test(navigator.userAgent);var dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var packetslist=keys(packets);var err={type:"error",data:"parser error"};var Blob=__webpack_require__(34);exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){if("function"==typeof supportsBinary){callback=supportsBinary;supportsBinary=false}if("function"==typeof utf8encode){callback=utf8encode;utf8encode=null}var data=packet.data===undefined?undefined:packet.data.buffer||packet.data;if(global.ArrayBuffer&&data instanceof ArrayBuffer){return encodeArrayBuffer(packet,supportsBinary,callback)}else if(Blob&&data instanceof global.Blob){return encodeBlob(packet,supportsBinary,callback)}if(data&&data.base64){return encodeBase64Object(packet,callback)}var encoded=packets[packet.type];if(undefined!==packet.data){encoded+=utf8encode?utf8.encode(String(packet.data)):String(packet.data)}return callback(""+encoded)};function encodeBase64Object(packet,callback){var message="b"+exports.packets[packet.type]+packet.data.data;return callback(message)}function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}var data=packet.data;var contentArray=new Uint8Array(data);var resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++){resultBuffer[i+1]=contentArray[i]}return callback(resultBuffer.buffer)}function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}var fr=new FileReader;fr.onload=function(){packet.data=fr.result;exports.encodePacket(packet,supportsBinary,true,callback)};return fr.readAsArrayBuffer(packet.data)}function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary){return exports.encodeBase64Packet(packet,callback)}if(dontSendBlobs){return encodeBlobAsArrayBuffer(packet,supportsBinary,callback)}var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob)}exports.encodeBase64Packet=function(packet,callback){var message="b"+exports.packets[packet.type];if(Blob&&packet.data instanceof global.Blob){var fr=new FileReader;fr.onload=function(){var b64=fr.result.split(",")[1];callback(message+b64)};return fr.readAsDataURL(packet.data)}var b64data;try{b64data=String.fromCharCode.apply(null,new Uint8Array(packet.data))}catch(e){var typed=new Uint8Array(packet.data);var basic=new Array(typed.length);for(var i=0;i<typed.length;i++){basic[i]=typed[i]}b64data=String.fromCharCode.apply(null,basic)}message+=global.btoa(b64data);return callback(message)};exports.decodePacket=function(data,binaryType,utf8decode){if(data===undefined){return err}if(typeof data=="string"){if(data.charAt(0)=="b"){return exports.decodeBase64Packet(data.substr(1),binaryType)}if(utf8decode){data=tryDecode(data);if(data===false){return err}}var type=data.charAt(0);if(Number(type)!=type||!packetslist[type]){return err}if(data.length>1){return{type:packetslist[type],data:data.substring(1)}}else{return{type:packetslist[type]}}}var asArray=new Uint8Array(data);var type=asArray[0];var rest=sliceBuffer(data,1);if(Blob&&binaryType==="blob"){rest=new Blob([rest])}return{type:packetslist[type],data:rest}};function tryDecode(data){try{data=utf8.decode(data)}catch(e){return false}return data}exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!base64encoder){return{type:type,data:{base64:true,data:msg.substr(1)}}}var data=base64encoder.decode(msg.substr(1));if(binaryType==="blob"&&Blob){data=new Blob([data])}return{type:type,data:data}};exports.encodePayload=function(packets,supportsBinary,callback){if(typeof supportsBinary=="function"){callback=supportsBinary;supportsBinary=null}var isBinary=hasBinary(packets);if(supportsBinary&&isBinary){if(Blob&&!dontSendBlobs){return exports.encodePayloadAsBlob(packets,callback)}return exports.encodePayloadAsArrayBuffer(packets,callback)}if(!packets.length){return callback("0:")}function setLengthHeader(message){return message.length+":"+message}function encodeOne(packet,doneCallback){exports.encodePacket(packet,!isBinary?false:supportsBinary,true,function(message){doneCallback(null,setLengthHeader(message))})}map(packets,encodeOne,function(err,results){return callback(results.join(""))})};function map(ary,each,done){var result=new Array(ary.length);var next=after(ary.length,done);var eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg;cb(error,result)})};for(var i=0;i<ary.length;i++){eachWithIndex(i,ary[i],next)}}exports.decodePayload=function(data,binaryType,callback){if(typeof data!="string"){return exports.decodePayloadAsBinary(data,binaryType,callback)}if(typeof binaryType==="function"){callback=binaryType;binaryType=null}var packet;if(data==""){return callback(err,0,1)}var length="",n,msg;for(var i=0,l=data.length;i<l;i++){var chr=data.charAt(i);if(":"!=chr){length+=chr}else{if(""==length||length!=(n=Number(length))){return callback(err,0,1)}msg=data.substr(i+1,n);if(length!=msg.length){return callback(err,0,1)}if(msg.length){packet=exports.decodePacket(msg,binaryType,true);if(err.type==packet.type&&err.data==packet.data){return callback(err,0,1)}var ret=callback(packet,i+n,l);if(false===ret)return}i+=n;length=""}}if(length!=""){return callback(err,0,1)}};exports.encodePayloadAsArrayBuffer=function(packets,callback){if(!packets.length){return callback(new ArrayBuffer(0))}function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(data){return doneCallback(null,data)})}map(packets,encodeOne,function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;if(typeof p==="string"){len=p.length}else{len=p.byteLength}return acc+len.toString().length+len+2},0);var resultArray=new Uint8Array(totalLength);var bufferIndex=0;encodedPackets.forEach(function(p){var isString=typeof p==="string";var ab=p;if(isString){var view=new Uint8Array(p.length);for(var i=0;i<p.length;i++){view[i]=p.charCodeAt(i)}ab=view.buffer}if(isString){resultArray[bufferIndex++]=0}else{resultArray[bufferIndex++]=1}var lenStr=ab.byteLength.toString();for(var i=0;i<lenStr.length;i++){resultArray[bufferIndex++]=parseInt(lenStr[i])}resultArray[bufferIndex++]=255;var view=new Uint8Array(ab);for(var i=0;i<view.length;i++){resultArray[bufferIndex++]=view[i]}});return callback(resultArray.buffer)})};exports.encodePayloadAsBlob=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,true,true,function(encoded){var binaryIdentifier=new Uint8Array(1);binaryIdentifier[0]=1;if(typeof encoded==="string"){var view=new Uint8Array(encoded.length);for(var i=0;i<encoded.length;i++){view[i]=encoded.charCodeAt(i)}encoded=view.buffer;binaryIdentifier[0]=0}var len=encoded instanceof ArrayBuffer?encoded.byteLength:encoded.size;var lenStr=len.toString();var lengthAry=new Uint8Array(lenStr.length+1);for(var i=0;i<lenStr.length;i++){lengthAry[i]=parseInt(lenStr[i])}lengthAry[lenStr.length]=255;if(Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob)}})}map(packets,encodeOne,function(err,results){return callback(new Blob(results))})};exports.decodePayloadAsBinary=function(data,binaryType,callback){if(typeof binaryType==="function"){callback=binaryType;binaryType=null}var bufferTail=data;var buffers=[];var numberTooLong=false;while(bufferTail.byteLength>0){var tailArray=new Uint8Array(bufferTail);var isString=tailArray[0]===0;var msgLength="";for(var i=1;;i++){if(tailArray[i]==255)break;if(msgLength.length>310){numberTooLong=true;break}msgLength+=tailArray[i]}if(numberTooLong)return callback(err,0,1);bufferTail=sliceBuffer(bufferTail,2+msgLength.length);msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString){try{msg=String.fromCharCode.apply(null,new Uint8Array(msg))}catch(e){var typed=new Uint8Array(msg);msg="";for(var i=0;i<typed.length;i++){msg+=String.fromCharCode(typed[i])}}}buffers.push(msg);bufferTail=sliceBuffer(bufferTail,msgLength)}var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,true),i,total)})}}).call(exports,function(){return this}())},function(module,exports){module.exports=Object.keys||function keys(obj){var arr=[];var has=Object.prototype.hasOwnProperty;for(var i in obj){if(has.call(obj,i)){arr.push(i)}}return arr}},function(module,exports,__webpack_require__){(function(global){var isArray=__webpack_require__(15);module.exports=hasBinary;function hasBinary(data){function _hasBinary(obj){if(!obj)return false;if(global.Buffer&&global.Buffer.isBuffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer||global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){return true}if(isArray(obj)){for(var i=0;i<obj.length;i++){if(_hasBinary(obj[i])){return true}}}else if(obj&&"object"==typeof obj){if(obj.toJSON&&"function"==typeof obj.toJSON){obj=obj.toJSON()}for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)&&_hasBinary(obj[key])){return true}}}return false}return _hasBinary(data)}}).call(exports,function(){return this}())},function(module,exports){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;start=start||0;end=end||bytes;if(arraybuffer.slice){return arraybuffer.slice(start,end)}if(start<0){start+=bytes}if(end<0){end+=bytes}if(end>bytes){end=bytes}if(start>=bytes||start>=end||bytes===0){return new ArrayBuffer(0)}var abv=new Uint8Array(arraybuffer);var result=new Uint8Array(end-start);for(var i=start,ii=0;i<end;i++,ii++){result[ii]=abv[i]}return result.buffer}},function(module,exports){module.exports=after;function after(count,callback,err_cb){var bail=false;err_cb=err_cb||noop;proxy.count=count;return count===0?callback():proxy;function proxy(err,result){if(proxy.count<=0){throw new Error("after called too many times")}--proxy.count;if(err){bail=true;callback(err);callback=err_cb}else if(proxy.count===0&&!bail){callback(null,result)}}}function noop(){}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;(function(module,global){(function(root){var freeExports=typeof exports=="object"&&exports;var freeModule=typeof module=="object"&&module&&module.exports==freeExports&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){root=freeGlobal}var stringFromCharCode=String.fromCharCode;function ucs2decode(string){var output=[];var counter=0;var length=string.length;var value;var extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){var length=array.length;var index=-1;var value;var output="";while(++index<length){value=array[index];if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value)}return output}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if((codePoint&4294967168)==0){return stringFromCharCode(codePoint)}var symbol="";if((codePoint&4294965248)==0){symbol=stringFromCharCode(codePoint>>6&31|192)}else if((codePoint&4294901760)==0){symbol=stringFromCharCode(codePoint>>12&15|224);symbol+=createByte(codePoint,6)}else if((codePoint&4292870144)==0){symbol=stringFromCharCode(codePoint>>18&7|240);symbol+=createByte(codePoint,12);symbol+=createByte(codePoint,6)}symbol+=stringFromCharCode(codePoint&63|128);return symbol}function wtf8encode(string){var codePoints=ucs2decode(string);var length=codePoints.length;var index=-1;var codePoint;var byteString="";while(++index<length){codePoint=codePoints[index];byteString+=encodeCodePoint(codePoint)}return byteString}function readContinuationByte(){if(byteIndex>=byteCount){throw Error("Invalid byte index")}var continuationByte=byteArray[byteIndex]&255;byteIndex++;if((continuationByte&192)==128){return continuationByte&63}throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1;var byte2;var byte3;var byte4;var codePoint;if(byteIndex>byteCount){throw Error("Invalid byte index")}if(byteIndex==byteCount){return false}byte1=byteArray[byteIndex]&255;byteIndex++;if((byte1&128)==0){return byte1}if((byte1&224)==192){var byte2=readContinuationByte();codePoint=(byte1&31)<<6|byte2;if(codePoint>=128){return codePoint}else{throw Error("Invalid continuation byte")}}if((byte1&240)==224){byte2=readContinuationByte();byte3=readContinuationByte();codePoint=(byte1&15)<<12|byte2<<6|byte3;if(codePoint>=2048){return codePoint}else{throw Error("Invalid continuation byte")}}if((byte1&248)==240){byte2=readContinuationByte();byte3=readContinuationByte();byte4=readContinuationByte();codePoint=(byte1&15)<<18|byte2<<12|byte3<<6|byte4;if(codePoint>=65536&&codePoint<=1114111){return codePoint}}throw Error("Invalid WTF-8 detected")}var byteArray;var byteCount;var byteIndex;function wtf8decode(byteString){byteArray=ucs2decode(byteString);byteCount=byteArray.length;byteIndex=0;var codePoints=[];var tmp;while((tmp=decodeSymbol())!==false){codePoints.push(tmp)}return ucs2encode(codePoints)}var wtf8={version:"1.0.0",encode:wtf8encode,decode:wtf8decode};if(true){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return wtf8}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else if(freeExports&&!freeExports.nodeType){if(freeModule){freeModule.exports=wtf8}else{var object={};var hasOwnProperty=object.hasOwnProperty;for(var key in wtf8){hasOwnProperty.call(wtf8,key)&&(freeExports[key]=wtf8[key])}}}else{root.wtf8=wtf8}})(this)}).call(exports,__webpack_require__(12)(module),function(){return this}())},function(module,exports){(function(){"use strict";var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var lookup=new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i}exports.encode=function(arraybuffer){var bytes=new Uint8Array(arraybuffer),i,len=bytes.length,base64="";for(i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[(bytes[i]&3)<<4|bytes[i+1]>>4];base64+=chars[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64+=chars[bytes[i+2]&63]}if(len%3===2){base64=base64.substring(0,base64.length-1)+"="}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"=="}return base64};exports.decode=function(base64){var bufferLength=base64.length*.75,len=base64.length,i,p=0,encoded1,encoded2,encoded3,encoded4;if(base64[base64.length-1]==="="){bufferLength--;if(base64[base64.length-2]==="="){bufferLength--}}var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4){encoded1=lookup[base64.charCodeAt(i)];encoded2=lookup[base64.charCodeAt(i+1)];encoded3=lookup[base64.charCodeAt(i+2)];encoded4=lookup[base64.charCodeAt(i+3)];bytes[p++]=encoded1<<2|encoded2>>4;bytes[p++]=(encoded2&15)<<4|encoded3>>2;bytes[p++]=(encoded3&3)<<6|encoded4&63}return arraybuffer}})()},function(module,exports){(function(global){var BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder;var blobSupported=function(){try{var a=new Blob(["hi"]);return a.size===2}catch(e){return false}}();var blobSupportsArrayBufferView=blobSupported&&function(){try{var b=new Blob([new Uint8Array([1,2])]);return b.size===2}catch(e){return false}}();var blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;function mapArrayBufferViews(ary){for(var i=0;i<ary.length;i++){var chunk=ary[i];if(chunk.buffer instanceof ArrayBuffer){var buf=chunk.buffer;if(chunk.byteLength!==buf.byteLength){var copy=new Uint8Array(chunk.byteLength);copy.set(new Uint8Array(buf,chunk.byteOffset,chunk.byteLength));buf=copy.buffer}ary[i]=buf}}}function BlobBuilderConstructor(ary,options){options=options||{};var bb=new BlobBuilder;mapArrayBufferViews(ary);for(var i=0;i<ary.length;i++){bb.append(ary[i])}return options.type?bb.getBlob(options.type):bb.getBlob()}function BlobConstructor(ary,options){mapArrayBufferViews(ary);return new Blob(ary,options||{})}module.exports=function(){if(blobSupported){return blobSupportsArrayBufferView?global.Blob:BlobConstructor}else if(blobBuilderSupported){return BlobBuilderConstructor}else{return undefined}}()}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){if(true){module.exports=Emitter}function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},function(module,exports){exports.encode=function(obj){var str="";for(var i in obj){if(obj.hasOwnProperty(i)){if(str.length)str+="&";str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i])}}return str};exports.decode=function(qs){var qry={};var pairs=qs.split("&");for(var i=0,l=pairs.length;i<l;i++){var pair=pairs[i].split("=");qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return qry}},function(module,exports){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype;a.prototype=new fn;a.prototype.constructor=a}},function(module,exports){"use strict";var alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={},seed=0,i=0,prev;function encode(num){var encoded="";do{encoded=alphabet[num%length]+encoded;num=Math.floor(num/length)}while(num>0);return encoded}function decode(str){var decoded=0;for(i=0;i<str.length;i++){decoded=decoded*length+map[str.charAt(i)]}return decoded}function yeast(){var now=encode(+new Date);if(now!==prev)return seed=0,prev=now;return now+"."+encode(seed++)}for(;i<length;i++)map[alphabet[i]]=i;yeast.encode=encode;yeast.decode=decode;module.exports=yeast},function(module,exports,__webpack_require__){(function(global){var Polling=__webpack_require__(25);var inherit=__webpack_require__(37);module.exports=JSONPPolling;var rNewline=/\n/g;var rEscapedNewline=/\\n/g;var callbacks;function empty(){}function JSONPPolling(opts){Polling.call(this,opts);this.query=this.query||{};if(!callbacks){if(!global.___eio)global.___eio=[];callbacks=global.___eio}this.index=callbacks.length;var self=this;callbacks.push(function(msg){self.onData(msg)});this.query.j=this.index;if(global.document&&global.addEventListener){global.addEventListener("beforeunload",function(){if(self.script)self.script.onerror=empty},false)}}inherit(JSONPPolling,Polling);JSONPPolling.prototype.supportsBinary=false;JSONPPolling.prototype.doClose=function(){if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}if(this.form){this.form.parentNode.removeChild(this.form);this.form=null;this.iframe=null}Polling.prototype.doClose.call(this)};JSONPPolling.prototype.doPoll=function(){var self=this;var script=document.createElement("script");if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}script.async=true;script.src=this.uri();script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];if(insertAt){insertAt.parentNode.insertBefore(script,insertAt)}else{(document.head||document.body).appendChild(script)}this.script=script;var isUAgecko="undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent);if(isUAgecko){setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe);document.body.removeChild(iframe)},100)}};JSONPPolling.prototype.doWrite=function(data,fn){var self=this;if(!this.form){var form=document.createElement("form");var area=document.createElement("textarea");var id=this.iframeId="eio_iframe_"+this.index;var iframe;form.className="socketio";form.style.position="absolute";form.style.top="-1000px";form.style.left="-1000px";form.target=id;form.method="POST";form.setAttribute("accept-charset","utf-8");area.name="d";form.appendChild(area);document.body.appendChild(form);this.form=form;this.area=area}this.form.action=this.uri();function complete(){initIframe();fn()}function initIframe(){if(self.iframe){try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}}try{var html='<iframe src="javascript:0" name="'+self.iframeId+'">';iframe=document.createElement(html)}catch(e){iframe=document.createElement("iframe");iframe.name=self.iframeId;iframe.src="javascript:0"}iframe.id=self.iframeId;self.form.appendChild(iframe);self.iframe=iframe}initIframe();data=data.replace(rEscapedNewline,"\\\n");this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}if(this.iframe.attachEvent){this.iframe.onreadystatechange=function(){if(self.iframe.readyState==="complete"){complete()}}}else{this.iframe.onload=complete}}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){(function(global){var Transport=__webpack_require__(26);var parser=__webpack_require__(27);var parseqs=__webpack_require__(36);var inherit=__webpack_require__(37);var yeast=__webpack_require__(38);var debug=__webpack_require__(3)("engine.io-client:websocket");var BrowserWebSocket=global.WebSocket||global.MozWebSocket;var NodeWebSocket;if(typeof window==="undefined"){try{NodeWebSocket=__webpack_require__(41)}catch(e){}}var WebSocket=BrowserWebSocket;if(!WebSocket&&typeof window==="undefined"){WebSocket=NodeWebSocket}module.exports=WS;function WS(opts){var forceBase64=opts&&opts.forceBase64;if(forceBase64){this.supportsBinary=false}this.perMessageDeflate=opts.perMessageDeflate;this.usingBrowserWebSocket=BrowserWebSocket&&!opts.forceNode;if(!this.usingBrowserWebSocket){WebSocket=NodeWebSocket}Transport.call(this,opts)}inherit(WS,Transport);WS.prototype.name="websocket";WS.prototype.supportsBinary=true;WS.prototype.doOpen=function(){if(!this.check()){return}var uri=this.uri();var protocols=void 0;var opts={agent:this.agent,perMessageDeflate:this.perMessageDeflate};opts.pfx=this.pfx;opts.key=this.key;opts.passphrase=this.passphrase;opts.cert=this.cert;opts.ca=this.ca;opts.ciphers=this.ciphers;opts.rejectUnauthorized=this.rejectUnauthorized;if(this.extraHeaders){opts.headers=this.extraHeaders}if(this.localAddress){opts.localAddress=this.localAddress}try{this.ws=this.usingBrowserWebSocket?new WebSocket(uri):new WebSocket(uri,protocols,opts)}catch(err){return this.emit("error",err)}if(this.ws.binaryType===undefined){this.supportsBinary=false}if(this.ws.supports&&this.ws.supports.binary){
this.supportsBinary=true;this.ws.binaryType="nodebuffer"}else{this.ws.binaryType="arraybuffer"}this.addEventListeners()};WS.prototype.addEventListeners=function(){var self=this;this.ws.onopen=function(){self.onOpen()};this.ws.onclose=function(){self.onClose()};this.ws.onmessage=function(ev){self.onData(ev.data)};this.ws.onerror=function(e){self.onError("websocket error",e)}};WS.prototype.write=function(packets){var self=this;this.writable=false;var total=packets.length;for(var i=0,l=total;i<l;i++){(function(packet){parser.encodePacket(packet,self.supportsBinary,function(data){if(!self.usingBrowserWebSocket){var opts={};if(packet.options){opts.compress=packet.options.compress}if(self.perMessageDeflate){var len="string"===typeof data?global.Buffer.byteLength(data):data.length;if(len<self.perMessageDeflate.threshold){opts.compress=false}}}try{if(self.usingBrowserWebSocket){self.ws.send(data)}else{self.ws.send(data,opts)}}catch(e){debug("websocket closed before onclose event")}--total||done()})})(packets[i])}function done(){self.emit("flush");setTimeout(function(){self.writable=true;self.emit("drain")},0)}};WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)};WS.prototype.doClose=function(){if(typeof this.ws!=="undefined"){this.ws.close()}};WS.prototype.uri=function(){var query=this.query||{};var schema=this.secure?"wss":"ws";var port="";if(this.port&&("wss"===schema&&Number(this.port)!==443||"ws"===schema&&Number(this.port)!==80)){port=":"+this.port}if(this.timestampRequests){query[this.timestampParam]=yeast()}if(!this.supportsBinary){query.b64=1}query=parseqs.encode(query);if(query.length){query="?"+query}var ipv6=this.hostname.indexOf(":")!==-1;return schema+"://"+(ipv6?"["+this.hostname+"]":this.hostname)+port+this.path+query};WS.prototype.check=function(){return!!WebSocket&&!("__initialize"in WebSocket&&this.name===WS.prototype.name)}}).call(exports,function(){return this}())},function(module,exports){},function(module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i){if(arr[i]===obj)return i}return-1}},function(module,exports){(function(global){var rvalidchars=/^[\],:{}\s]*$/;var rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g;var rtrimLeft=/^\s+/;var rtrimRight=/\s+$/;module.exports=function parsejson(data){if("string"!=typeof data||!data){return null}data=data.replace(rtrimLeft,"").replace(rtrimRight,"");if(global.JSON&&JSON.parse){return JSON.parse(data)}if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return new Function("return "+data)()}}}).call(exports,function(){return this}())},function(module,exports,__webpack_require__){"use strict";var parser=__webpack_require__(7);var Emitter=__webpack_require__(35);var toArray=__webpack_require__(45);var on=__webpack_require__(46);var bind=__webpack_require__(47);var debug=__webpack_require__(3)("socket.io-client:socket");var hasBin=__webpack_require__(29);module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1};var emit=Emitter.prototype.emit;function Socket(io,nsp,opts){this.io=io;this.nsp=nsp;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;if(opts&&opts.query){this.query=opts.query}if(this.io.autoConnect)this.open()}Emitter(Socket.prototype);Socket.prototype.subEvents=function(){if(this.subs)return;var io=this.io;this.subs=[on(io,"open",bind(this,"onopen")),on(io,"packet",bind(this,"onpacket")),on(io,"close",bind(this,"onclose"))]};Socket.prototype.open=Socket.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"===this.io.readyState)this.onopen();this.emit("connecting");return this};Socket.prototype.send=function(){var args=toArray(arguments);args.unshift("message");this.emit.apply(this,args);return this};Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev)){emit.apply(this,arguments);return this}var args=toArray(arguments);var parserType=parser.EVENT;if(hasBin(args)){parserType=parser.BINARY_EVENT}var packet={type:parserType,data:args};packet.options={};packet.options.compress=!this.flags||false!==this.flags.compress;if("function"===typeof args[args.length-1]){debug("emitting packet with ack id %d",this.ids);this.acks[this.ids]=args.pop();packet.id=this.ids++}if(this.connected){this.packet(packet)}else{this.sendBuffer.push(packet)}delete this.flags;return this};Socket.prototype.packet=function(packet){packet.nsp=this.nsp;this.io.packet(packet)};Socket.prototype.onopen=function(){debug("transport is open - connecting");if("/"!==this.nsp){if(this.query){this.packet({type:parser.CONNECT,query:this.query})}else{this.packet({type:parser.CONNECT})}}};Socket.prototype.onclose=function(reason){debug("close (%s)",reason);this.connected=false;this.disconnected=true;delete this.id;this.emit("disconnect",reason)};Socket.prototype.onpacket=function(packet){if(packet.nsp!==this.nsp)return;switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",packet.data);break}};Socket.prototype.onevent=function(packet){var args=packet.data||[];debug("emitting event %j",args);if(null!=packet.id){debug("attaching ack callback to event");args.push(this.ack(packet.id))}if(this.connected){emit.apply(this,args)}else{this.receiveBuffer.push(args)}};Socket.prototype.ack=function(id){var self=this;var sent=false;return function(){if(sent)return;sent=true;var args=toArray(arguments);debug("sending ack %j",args);var type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({type:type,id:id,data:args})}};Socket.prototype.onack=function(packet){var ack=this.acks[packet.id];if("function"===typeof ack){debug("calling ack %s with %j",packet.id,packet.data);ack.apply(this,packet.data);delete this.acks[packet.id]}else{debug("bad ack %s",packet.id)}};Socket.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit("connect");this.emitBuffered()};Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++){emit.apply(this,this.receiveBuffer[i])}this.receiveBuffer=[];for(i=0;i<this.sendBuffer.length;i++){this.packet(this.sendBuffer[i])}this.sendBuffer=[]};Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};Socket.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++){this.subs[i].destroy()}this.subs=null}this.io.destroy(this)};Socket.prototype.close=Socket.prototype.disconnect=function(){if(this.connected){debug("performing disconnect (%s)",this.nsp);this.packet({type:parser.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this};Socket.prototype.compress=function(compress){this.flags=this.flags||{};this.flags.compress=compress;return this}},function(module,exports){module.exports=toArray;function toArray(list,index){var array=[];index=index||0;for(var i=index||0;i<list.length;i++){array[i-index]=list[i]}return array}},function(module,exports){"use strict";module.exports=on;function on(obj,ev,fn){obj.on(ev,fn);return{destroy:function destroy(){obj.removeListener(ev,fn)}}}},function(module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn)fn=obj[fn];if("function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},function(module,exports){module.exports=Backoff;function Backoff(opts){opts=opts||{};this.ms=opts.min||100;this.max=opts.max||1e4;this.factor=opts.factor||2;this.jitter=opts.jitter>0&&opts.jitter<=1?opts.jitter:0;this.attempts=0}Backoff.prototype.duration=function(){var ms=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random();var deviation=Math.floor(rand*this.jitter*ms);ms=(Math.floor(rand*10)&1)==0?ms-deviation:ms+deviation}return Math.min(ms,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(min){this.ms=min};Backoff.prototype.setMax=function(max){this.max=max};Backoff.prototype.setJitter=function(jitter){this.jitter=jitter}}])});(function(scope,name,factory){if(typeof define==="function"&&define.amd){define(name,factory)}else{scope[name]=factory()}})(this,"SocketIOFileUpload",function(){return function(socket){"use strict";var self=this;if(!window.File||!window.FileReader){throw new Error("Socket.IO File Upload: Browser Not Supported")}var callbacks={},uploadedFiles=[],readyCallbacks=[];self.fileInputElementId="siofu_input";self.useText=false;self.serializedOctets=false;self.useBuffer=false;var _dispatch=function(eventName,properties){var evnt=document.createEvent("Event");evnt.initEvent(eventName,false,false);for(var prop in properties){if(properties.hasOwnProperty(prop)){evnt[prop]=properties[prop]}}return self.dispatchEvent(evnt)};var _listenedReferences=[];var _listenTo=function(object,eventName,callback,bubble){object.addEventListener(eventName,callback,bubble);_listenedReferences.push(arguments)};var _stopListeningTo=function(object,eventName,callback,bubble){if(object.removeEventListener){object.removeEventListener(eventName,callback,bubble)}};var _stopListening=function(){for(var i=_listenedReferences.length-1;i>=0;i--){_stopListeningTo.apply(this,_listenedReferences[i])}_listenedReferences=[]};var _loadOne=function(file){if(self.maxFileSize!==null&&file.size>self.maxFileSize){_dispatch("error",{file:file,message:"Attempt by client to upload file exceeding the maximum file size",code:1});return}var evntResult=_dispatch("start",{file:file});if(!evntResult)return;var reader=new FileReader,transmitPos=0,id=uploadedFiles.length,useText=self.useText,newName;uploadedFiles.push(file);var transmitPart=function(loaded){var content,isBase64=false;if(useText){content=reader.result.slice(transmitPos,loaded)}else{try{var uintArr=new Uint8Array(reader.result,transmitPos,loaded);if(self.serializedOctets){content=uintArr}else if(self.useBuffer){content=uintArr.buffer}else{isBase64=true;content=_uint8ArrayToBase64(uintArr)}}catch(error){socket.emit("siofu_done",{id:id,interrupt:true});return}}socket.emit("siofu_progress",{id:id,start:transmitPos,end:loaded,content:content,base64:isBase64});transmitPos=loaded};_listenTo(reader,"progress",function(event){});_listenTo(reader,"load",function(event){transmitPart(event.loaded);socket.emit("siofu_done",{id:id});_dispatch("load",{file:file,reader:reader,name:newName})});_listenTo(reader,"error",function(){socket.emit("siofu_done",{id:id,interrupt:true})});_listenTo(reader,"abort",function(){socket.emit("siofu_done",{id:id,interrupt:true})});socket.emit("siofu_start",{name:file.name,mtime:file.lastModifiedDate,meta:file.meta,encoding:useText?"text":"octet",id:id});var readyCallback;if(useText){readyCallback=function(_newName){reader.readAsText(file);newName=_newName}}else{readyCallback=function(_newName){reader.readAsArrayBuffer(file);newName=_newName}}readyCallbacks.push(readyCallback)};var _load=function(files){for(var i=0;i<files.length;i++){_loadOne(files[i])}};var _getInputElement=function(){var inpt=document.getElementById(self.fileInputElementId);if(!inpt){inpt=document.createElement("input");inpt.setAttribute("type","file");inpt.setAttribute("id",self.fileInputElementId);inpt.style.display="none";document.body.appendChild(inpt)}return inpt};var _removeInputElement=function(){var inpt=document.getElementById(self.fileInputElementId);if(inpt){inpt.parentNode.removeChild(inpt)}};var _baseFileSelectCallback=function(files){if(files.length===0)return;for(var i=0;i<files.length;i++){files[i].meta={}}var evntResult=_dispatch("choose",{files:files});if(evntResult){_load(files)}};var _fileSelectCallback=function(event){var files=event.target.files||event.dataTransfer.files;event.preventDefault();_baseFileSelectCallback(files)};this.submitFiles=function(files){if(files){_baseFileSelectCallback(files)}};this.listenOnSubmit=function(submitButton,input){console.log("Listen");if(!input.files)return;_listenTo(submitButton,"click",function(){_baseFileSelectCallback(input.files)},false)};this.listenOnArraySubmit=function(submitButton,array){for(var index in array){this.listenOnSubmit(submitButton,array[index])}};this.listenOnInput=function(inpt){if(!inpt.files)return;_listenTo(inpt,"change",_fileSelectCallback,false)};this.listenOnDrop=function(div){_listenTo(div,"dragover",function(event){event.preventDefault()},false);_listenTo(div,"drop",_fileSelectCallback)};this.prompt=function(){var inpt=_getInputElement();_listenTo(inpt,"change",_fileSelectCallback,false);var evnt=document.createEvent("MouseEvents");evnt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);inpt.dispatchEvent(evnt)};this.destroy=function(){_stopListening();_removeInputElement()};this.addEventListener=function(eventName,callback){if(!callbacks[eventName])callbacks[eventName]=[];callbacks[eventName].push(callback)};this.removeEventListener=function(eventName,callback){if(!callbacks[eventName])return false;for(var i=0;i<callbacks[eventName].length;i++){if(callbacks[eventName][i]===callback){callbacks[eventName].splice(i,1);return true}}return false};this.dispatchEvent=function(evnt){var eventCallbacks=callbacks[evnt.type];if(!eventCallbacks)return true;var retVal=true;for(var i=0;i<eventCallbacks.length;i++){var callbackResult=eventCallbacks[i](evnt);if(callbackResult===false){retVal=false}}return retVal};var _uint8ArrayToBase64=function(bytes){var i,len=bytes.buffer.byteLength,base64="",chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[(bytes[i]&3)<<4|bytes[i+1]>>4];base64+=chars[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64+=chars[bytes[i+2]&63]}if(len%3===2){base64=base64.substring(0,base64.length-1)+"="}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"=="}return base64};socket.on("siofu_ready",function(data){readyCallbacks[data.id](data.name)});socket.on("siofu_complete",function(data){_dispatch("complete",{file:uploadedFiles[data.id],detail:data.detail,success:data.success})});socket.on("siofu_error",function(data){_dispatch("error",{file:uploadedFiles[data.id],message:data.message,code:0})})}});(function(scope,name,deps,factory){if(typeof define==="function"&&define.amd){define(name,deps,factory)}else{scope[name]=factory(io,SocketIOFileUpload)}})(this,"chat_widget",["io","SocketIOFileUpload"],function(io,SocketIOFileUpload){return new function(){var Light=function(selector,parent){return new Light.core.init(selector,parent)};var $=Light;Light.core=Light.prototype={init:function(selector,parent){var els;selector=selector||window;parent=parent||document;els=typeof selector=="string"?Light.selector(selector,parent):els=selector;this.els=[];if(typeof els.length!="undefined"){for(var i=0,max=els.length;i<max;i++)this.els.push(els[i])}else{this.els.push(els)}return this},get:function(index){return typeof index=="undefined"?this.els:this.els[index]},count:function(){return this.els.length},each:function(fn){for(var x=0,max=this.els.length;x<max;x++)fn.call(this,this.els[x]);return this},attr:function(name,value,type){this.each(function(el){if(typeof type=="undefined"){el[name]=value}else{el[type][name]=value}});return this},css:function(styles){var that=this;this.each(function(el){for(var name in styles)that.attr(name,styles[name],"style")});return this},addClass:function(className){this.each(function(el){el.className+=" "+className});return this},removeClass:function(className){this.each(function(el){el.className=el.className.replace(className,"")});return this},on:function(event,fn){var addEvent=function(el){if(window.addEventListener){el.addEventListener(event,fn,false)}else if(window.attachEvent){el.attachEvent("on"+event,function(){fn.call(el,window.event)})}};this.each(function(el){addEvent(el)});return this},ready:function(fn){DOMReady.add(fn);return this},remove:function(){this.each(function(el){el.parentNode.removeChild(el)});return this}};Light.selector=function(selector,context){var sels=selector.split(","),el,op,s;for(var x=0;x<sels.length;x++){var sel=sels[x].replace(/ /g,"");if(typeof sel=="string"){op=sel.substr(0,1);s=sel.substr(1);if(op=="#"){el=document.getElementById(s);el=isDescendant(el,context)?el:null}else if(op=="."){el=getElementsByClassName(s,context)}else{el=context.getElementsByTagName(sel)}}}return el};Light.core.init.prototype=Light.core;var DOMReady=function(){var fns=[],isReady=false,ready=function(){isReady=true;for(var x=0;x<fns.length;x++)fns[x].call()};this.add=function(fn){if(fn.constructor==String){var strFunc=fn;fn=function(){eval(strFunc)}}if(isReady){fn.call()}else{fns[fns.length]=fn}};if(window.addEventListener)document.addEventListener("DOMContentLoaded",function(){ready()},false);(function(){if(!document.uniqueID&&document.expando)return;var tempNode=document.createElement("document:ready");try{tempNode.doScroll("left");ready()}catch(err){setTimeout(arguments.callee,0)}})();return this}();Light.ready=DOMReady.add;function isDescendant(desc,anc){return desc.parentNode==anc||desc.parentNode!=document&&isDescendant(desc.parentNode,anc)}function getElementsByClassName(className,parent){var a=[],re=new RegExp("\\b"+className+"\\b"),els=parent.getElementsByTagName("*");parent=parent||document.getElementsByTagName("body")[0];for(var i=0,j=els.length;i<j;i++)if(re.test(els[i].className))a.push(els[i]);return a}(function(){function n(n){function t(t,r,e,u,i,o){for(;i>=0&&o>i;i+=n){var a=u?u[i]:i;e=r(e,t[a],a,t)}return e}return function(r,e,u,i){e=b(e,i,4);var o=!k(r)&&m.keys(r),a=(o||r).length,c=n>0?0:a-1;return arguments.length<3&&(u=r[o?o[c]:c],c+=n),t(r,e,u,o,c,a)}}function t(n){return function(t,r,e){r=x(r,e);for(var u=O(t),i=n>0?0:u-1;i>=0&&u>i;i+=n)if(r(t[i],i,t))return i;return-1}}function r(n,t,r){return function(e,u,i){var o=0,a=O(e);if("number"==typeof i)n>0?o=i>=0?i:Math.max(i+a,o):a=i>=0?Math.min(i+1,a):i+a+1;else if(r&&i&&a)return i=r(e,u),e[i]===u?i:-1;if(u!==u)return i=t(l.call(e,o,a),m.isNaN),i>=0?i+o:-1;for(i=n>0?o:a-1;i>=0&&a>i;i+=n)if(e[i]===u)return i;return-1}}function e(n,t){var r=I.length,e=n.constructor,u=m.isFunction(e)&&e.prototype||a,i="constructor";for(m.has(n,i)&&!m.contains(t,i)&&t.push(i);r--;)i=I[r],i in n&&n[i]!==u[i]&&!m.contains(t,i)&&t.push(i)}var u=this,i=u._,o=Array.prototype,a=Object.prototype,c=Function.prototype,f=o.push,l=o.slice,s=a.toString,p=a.hasOwnProperty,h=Array.isArray,v=Object.keys,g=c.bind,y=Object.create,d=function(){},m=function(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):u._=m,m.VERSION="1.8.3";var b=function(n,t,r){if(t===void 0)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}},x=function(n,t,r){return null==n?m.identity:m.isFunction(n)?b(n,t,r):m.isObject(n)?m.matcher(n):m.property(n)};m.iteratee=function(n,t){return x(n,t,1/0)};var _=function(n,t){return function(r){var e=arguments.length;if(2>e||null==r)return r;for(var u=1;e>u;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;a>c;c++){var f=o[c];t&&r[f]!==void 0||(r[f]=i[f])}return r}},j=function(n){if(!m.isObject(n))return{};if(y)return y(n);d.prototype=n;var t=new d;return d.prototype=null,t},w=function(n){return function(t){return null==t?void 0:t[n]}},A=Math.pow(2,53)-1,O=w("length"),k=function(n){var t=O(n);return"number"==typeof t&&t>=0&&A>=t};m.each=m.forEach=function(n,t,r){t=b(t,r);var e,u;if(k(n))for(e=0,u=n.length;u>e;e++)t(n[e],e,n);else{var i=m.keys(n);for(e=0,u=i.length;u>e;e++)t(n[i[e]],i[e],n)}return n},m.map=m.collect=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=Array(u),o=0;u>o;o++){var a=e?e[o]:o;i[o]=t(n[a],a,n)}return i},m.reduce=m.foldl=m.inject=n(1),m.reduceRight=m.foldr=n(-1),m.find=m.detect=function(n,t,r){var e;return e=k(n)?m.findIndex(n,t,r):m.findKey(n,t,r),e!==void 0&&e!==-1?n[e]:void 0},m.filter=m.select=function(n,t,r){var e=[];return t=x(t,r),m.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e},m.reject=function(n,t,r){return m.filter(n,m.negate(x(t)),r)},m.every=m.all=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(!t(n[o],o,n))return!1}return!0},m.some=m.any=function(n,t,r){t=x(t,r);for(var e=!k(n)&&m.keys(n),u=(e||n).length,i=0;u>i;i++){var o=e?e[i]:i;if(t(n[o],o,n))return!0}return!1},m.contains=m.includes=m.include=function(n,t,r,e){return k(n)||(n=m.values(n)),("number"!=typeof r||e)&&(r=0),m.indexOf(n,t,r)>=0},m.invoke=function(n,t){var r=l.call(arguments,2),e=m.isFunction(t);return m.map(n,function(n){var u=e?t:n[t];return null==u?u:u.apply(n,r)})},m.pluck=function(n,t){return m.map(n,m.property(t))},m.where=function(n,t){return m.filter(n,m.matcher(t))},m.findWhere=function(n,t){return m.find(n,m.matcher(t))},m.max=function(n,t,r){var e,u,i=-1/0,o=-1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],e>i&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(u>o||u===-1/0&&i===-1/0)&&(i=n,o=u)});return i},m.min=function(n,t,r){var e,u,i=1/0,o=1/0;if(null==t&&null!=n){n=k(n)?n:m.values(n);for(var a=0,c=n.length;c>a;a++)e=n[a],i>e&&(i=e)}else t=x(t,r),m.each(n,function(n,r,e){u=t(n,r,e),(o>u||1/0===u&&1/0===i)&&(i=n,o=u)});return i},m.shuffle=function(n){for(var t,r=k(n)?n:m.values(n),e=r.length,u=Array(e),i=0;e>i;i++)t=m.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},m.sample=function(n,t,r){return null==t||r?(k(n)||(n=m.values(n)),n[m.random(n.length-1)]):m.shuffle(n).slice(0,Math.max(0,t))},m.sortBy=function(n,t,r){return t=x(t,r),m.pluck(m.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={};return r=x(r,e),m.each(t,function(e,i){var o=r(e,i,t);n(u,e,o)}),u}};m.groupBy=F(function(n,t,r){m.has(n,r)?n[r].push(t):n[r]=[t]}),m.indexBy=F(function(n,t,r){n[r]=t}),m.countBy=F(function(n,t,r){m.has(n,r)?n[r]++:n[r]=1}),m.toArray=function(n){return n?m.isArray(n)?l.call(n):k(n)?m.map(n,m.identity):m.values(n):[]},m.size=function(n){return null==n?0:k(n)?n.length:m.keys(n).length},m.partition=function(n,t,r){t=x(t,r);var e=[],u=[];return m.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},m.first=m.head=m.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:m.initial(n,n.length-t)},m.initial=function(n,t,r){return l.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},m.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:m.rest(n,Math.max(0,n.length-t))},m.rest=m.tail=m.drop=function(n,t,r){return l.call(n,null==t||r?1:t)},m.compact=function(n){return m.filter(n,m.identity)};var S=function(n,t,r,e){for(var u=[],i=0,o=e||0,a=O(n);a>o;o++){var c=n[o];if(k(c)&&(m.isArray(c)||m.isArguments(c))){t||(c=S(c,t,r));var f=0,l=c.length;for(u.length+=l;l>f;)u[i++]=c[f++]}else r||(u[i++]=c)}return u};m.flatten=function(n,t){return S(n,t,!1)},m.without=function(n){return m.difference(n,l.call(arguments,1))},m.uniq=m.unique=function(n,t,r,e){m.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=x(r,e));for(var u=[],i=[],o=0,a=O(n);a>o;o++){var c=n[o],f=r?r(c,o,n):c;t?(o&&i===f||u.push(c),i=f):r?m.contains(i,f)||(i.push(f),u.push(c)):m.contains(u,c)||u.push(c)}return u},m.union=function(){return m.uniq(S(arguments,!0,!0))},m.intersection=function(n){for(var t=[],r=arguments.length,e=0,u=O(n);u>e;e++){var i=n[e];if(!m.contains(t,i)){for(var o=1;r>o&&m.contains(arguments[o],i);o++);o===r&&t.push(i)}}return t},m.difference=function(n){var t=S(arguments,!0,!0,1);return m.filter(n,function(n){return!m.contains(t,n)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(n){for(var t=n&&m.max(n,O).length||0,r=Array(t),e=0;t>e;e++)r[e]=m.pluck(n,e);return r},m.object=function(n,t){for(var r={},e=0,u=O(n);u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},m.findIndex=t(1),m.findLastIndex=t(-1),m.sortedIndex=function(n,t,r,e){r=x(r,e,1);for(var u=r(t),i=0,o=O(n);o>i;){var a=Math.floor((i+o)/2);r(n[a])<u?i=a+1:o=a}return i},m.indexOf=r(1,m.findIndex,m.sortedIndex),m.lastIndexOf=r(-1,m.findLastIndex),m.range=function(n,t,r){null==t&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;e>i;i++,n+=r)u[i]=n;return u};var E=function(n,t,r,e,u){if(!(e instanceof t))return n.apply(r,u);var i=j(n.prototype),o=n.apply(i,u);return m.isObject(o)?o:i};m.bind=function(n,t){if(g&&n.bind===g)return g.apply(n,l.call(arguments,1));if(!m.isFunction(n))throw new TypeError("Bind must be called on a function");var r=l.call(arguments,2),e=function(){return E(n,e,t,this,r.concat(l.call(arguments)))};return e},m.partial=function(n){var t=l.call(arguments,1),r=function(){for(var e=0,u=t.length,i=Array(u),o=0;u>o;o++)i[o]=t[o]===m?arguments[e++]:t[o];for(;e<arguments.length;)i.push(arguments[e++]);return E(n,r,this,this,i)};return r},m.bindAll=function(n){var t,r,e=arguments.length;if(1>=e)throw new Error("bindAll must be passed function names");for(t=1;e>t;t++)r=arguments[t],n[r]=m.bind(n[r],n);return n},m.memoize=function(n,t){var r=function(e){var u=r.cache,i=""+(t?t.apply(this,arguments):e);return m.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},m.delay=function(n,t){var r=l.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},m.defer=m.partial(m.delay,m,1),m.throttle=function(n,t,r){var e,u,i,o=null,a=0;r||(r={});var c=function(){a=r.leading===!1?0:m.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var f=m.now();a||r.leading!==!1||(a=f);var l=t-(f-a);return e=this,u=arguments,0>=l||l>t?(o&&(clearTimeout(o),o=null),a=f,i=n.apply(e,u),o||(e=u=null)):o||r.trailing===!1||(o=setTimeout(c,l)),i}},m.debounce=function(n,t,r){var e,u,i,o,a,c=function(){var f=m.now()-o;t>f&&f>=0?e=setTimeout(c,t-f):(e=null,r||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=m.now();var f=r&&!e;return e||(e=setTimeout(c,t)),f&&(a=n.apply(i,u),i=u=null),a}},m.wrap=function(n,t){return m.partial(t,n)},m.negate=function(n){return function(){return!n.apply(this,arguments)}},m.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},m.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},m.before=function(n,t){var r;return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=null),r}},m.once=m.partial(m.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(n){if(!m.isObject(n))return[];if(v)return v(n);var t=[];for(var r in n)m.has(n,r)&&t.push(r);return M&&e(n,t),t},m.allKeys=function(n){if(!m.isObject(n))return[];var t=[];for(var r in n)t.push(r);return M&&e(n,t),t},m.values=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=n[t[u]];return e},m.mapObject=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=u.length,o={},a=0;i>a;a++)e=u[a],o[e]=t(n[e],e,n);return o},m.pairs=function(n){for(var t=m.keys(n),r=t.length,e=Array(r),u=0;r>u;u++)e[u]=[t[u],n[t[u]]];return e},m.invert=function(n){for(var t={},r=m.keys(n),e=0,u=r.length;u>e;e++)t[n[r[e]]]=r[e];return t},m.functions=m.methods=function(n){var t=[];for(var r in n)m.isFunction(n[r])&&t.push(r);return t.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(n,t,r){t=x(t,r);for(var e,u=m.keys(n),i=0,o=u.length;o>i;i++)if(e=u[i],t(n[e],e,n))return e},m.pick=function(n,t,r){var e,u,i={},o=n;if(null==o)return i;m.isFunction(t)?(u=m.allKeys(o),e=b(t,r)):(u=S(arguments,!1,!1,1),e=function(n,t,r){return t in r},o=Object(o));for(var a=0,c=u.length;c>a;a++){var f=u[a],l=o[f];e(l,f,o)&&(i[f]=l)}return i},m.omit=function(n,t,r){if(m.isFunction(t))t=m.negate(t);else{var e=m.map(S(arguments,!1,!1,1),String);t=function(n,t){return!m.contains(e,t)}}return m.pick(n,t,r)},m.defaults=_(m.allKeys,!0),m.create=function(n,t){var r=j(n);return t&&m.extendOwn(r,t),r},m.clone=function(n){return m.isObject(n)?m.isArray(n)?n.slice():m.extend({},n):n},m.tap=function(n,t){return t(n),n},m.isMatch=function(n,t){var r=m.keys(t),e=r.length;if(null==n)return!e;for(var u=Object(n),i=0;e>i;i++){var o=r[i];if(t[o]!==u[o]||!(o in u))return!1}return!0};var N=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof m&&(n=n._wrapped),t instanceof m&&(t=t._wrapped);var u=s.call(n);if(u!==s.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}var i="[object Array]"===u;if(!i){if("object"!=typeof n||"object"!=typeof t)return!1;var o=n.constructor,a=t.constructor;if(o!==a&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in t)return!1}r=r||[],e=e||[];for(var c=r.length;c--;)if(r[c]===n)return e[c]===t;if(r.push(n),e.push(t),i){if(c=n.length,c!==t.length)return!1;for(;c--;)if(!N(n[c],t[c],r,e))return!1}else{var f,l=m.keys(n);if(c=l.length,m.keys(t).length!==c)return!1;for(;c--;)if(f=l[c],!m.has(t,f)||!N(n[f],t[f],r,e))return!1}return r.pop(),e.pop(),!0};m.isEqual=function(n,t){return N(n,t)},m.isEmpty=function(n){return null==n?!0:k(n)&&(m.isArray(n)||m.isString(n)||m.isArguments(n))?0===n.length:0===m.keys(n).length},m.isElement=function(n){return!(!n||1!==n.nodeType)},m.isArray=h||function(n){return"[object Array]"===s.call(n)},m.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(n){m["is"+n]=function(t){return s.call(t)==="[object "+n+"]"}}),m.isArguments(arguments)||(m.isArguments=function(n){return m.has(n,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(n){return"function"==typeof n||!1}),m.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},m.isNaN=function(n){return m.isNumber(n)&&n!==+n},m.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===s.call(n)},m.isNull=function(n){return null===n},m.isUndefined=function(n){return n===void 0},m.has=function(n,t){return null!=n&&p.call(n,t)},m.noConflict=function(){return u._=i,this},m.identity=function(n){return n},m.constant=function(n){return function(){return n}},m.noop=function(){},m.property=w,m.propertyOf=function(n){return null==n?function(){}:function(t){return n[t]}},m.matcher=m.matches=function(n){return n=m.extendOwn({},n),function(t){return m.isMatch(t,n)}},m.times=function(n,t,r){var e=Array(Math.max(0,n));t=b(t,r,1);for(var u=0;n>u;u++)e[u]=t(u);return e},m.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},m.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},T=m.invert(B),R=function(n){var t=function(t){
return n[t]},r="(?:"+m.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};m.escape=R(B),m.unescape=R(T),m.result=function(n,t,r){var e=null==n?void 0:n[t];return e===void 0&&(e=r),m.isFunction(e)?e.call(n):e};var q=0;m.uniqueId=function(n){var t=++q+"";return n?n+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,L=function(n){return"\\"+z[n]};m.template=function(n,t,r){!t&&r&&(t=r),t=m.defaults({},t,m.templateSettings);var e=RegExp([(t.escape||K).source,(t.interpolate||K).source,(t.evaluate||K).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,o,a){return i+=n.slice(u,a).replace(D,L),u=a+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(a){throw a.source=i,a}var c=function(n){return o.call(this,n,m)},f=t.variable||"obj";return c.source="function("+f+"){\n"+i+"}",c},m.chain=function(n){var t=m(n);return t._chain=!0,t};var P=function(n,t){return n._chain?m(t).chain():t};m.mixin=function(n){m.each(m.functions(n),function(t){var r=m[t]=n[t];m.prototype[t]=function(){var n=[this._wrapped];return f.apply(n,arguments),P(this,r.apply(m,n))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=o[n];m.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],P(this,r)}}),m.each(["concat","join","slice"],function(n){var t=o[n];m.prototype[n]=function(){return P(this,t.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);function ratingInit(){"use strict";function rating(el,currentRating,maxRating,callback){var stars=[];(function init(){if(!el){throw Error("No element supplied.")}if(!maxRating){throw Error("No max rating supplied.")}if(!currentRating){currentRating=0}if(currentRating<0||currentRating>maxRating){throw Error("Current rating is out of bounds.")}for(var i=0;i<maxRating;i++){var star=document.createElement("li");star.classList.add("c-rating__item");star.setAttribute("data-index",i);if(i<currentRating){star.classList.add("is-active")}el.appendChild(star);stars.push(star);attachStarEvents(star)}})();function iterate(collection,callback){for(var i=0;i<collection.length;i++){var item=collection[i];callback(item,i)}}function attachStarEvents(star){starMouseOver(star);starMouseOut(star);starClick(star)}function starMouseOver(star){star.addEventListener("mouseover",function(e){iterate(stars,function(item,index){if(index<=parseInt(star.getAttribute("data-index"))){item.classList.add("is-active")}else{item.classList.remove("is-active")}})})}function starMouseOut(star){star.addEventListener("mouseout",function(e){if(stars.indexOf(e.relatedTarget)===-1){setRating(null,false)}})}function starClick(star){star.addEventListener("click",function(e){e.preventDefault();setRating(parseInt(star.getAttribute("data-index"))+1,true)})}function setRating(value,doCallback){if(value<0||value>maxRating){return}if(doCallback===undefined){doCallback=true}currentRating=value===0||value>0?value:currentRating;iterate(stars,function(star,index){if(index<currentRating){star.classList.add("is-active")}else{star.classList.remove("is-active")}});if(callback&&doCallback){callback(getRating())}}function getRating(){return currentRating}return{setRating:setRating,getRating:getRating}}window.JSFrame.rating=rating}function Core(){var self=this;var baseControllers={button:[],block:["queue","auth","offline","online","finish"]};var register={controller:{},service:{},config:{}};var runtime={controller:{},service:{}};self.windowProtocol=window.location.protocol==="http:"||window.location.protocol==="https:"?window.location.protocol:"https:";self.controller=function(name,handler,dependencies){register.controller[name]=[handler,dependencies]};self.service=function(name,handler,dependencies){register.service[name]=[handler,dependencies]};self.config=function(name,data){register.config[name]=data};self.run=function(){var router=self.getService("router");router.onChange(function(name,params){self.getController(name);for(var controllerName in baseControllers){var controller=self.getController(controllerName);if(controllerName===name){controller.show()}else{controller.hide();if(baseControllers[controllerName]&&baseControllers[controllerName].length>0){for(var i=0;i<baseControllers[controllerName].length;i++){self.getController(baseControllers[controllerName][i]).hide()}}}}if(baseControllers[name]&&baseControllers[name].length>0&&params){for(var i=0;i<baseControllers[name].length;i++){var controller=self.getController(baseControllers[name][i]);baseControllers[name][i]===params.action?controller.show():controller.hide()}}});var currentRoute=router.getCurrent();if(currentRoute){router.go.apply(null,currentRoute)}else{router.go("button")}};self.getController=function(name){if(!runtime.controller[name]){var controller=register.controller[name];runtime.controller[name]=new function(){Controller.apply(this,getDependencies(["template","dom","handler"]));controller[0].apply(this,getDependencies(controller[1]));this.template&&this.render()};runtime.controller[name].trigger("ready")}return runtime.controller[name]};self.getService=function(name){if(!runtime.service[name]){if(!register.service[name]){throw new Error('Service "'+name+'" not found')}var service=register.service[name];runtime.service[name]=new function(){service[0].apply(this,getDependencies(service[1]))}}return runtime.service[name]};self.getConfig=function(name){return register.config[name]};function getDependencies(names){var dependencies=[];if(names instanceof Array&&names.length>0){names.forEach(function(name){var config=self.getConfig(name);if(config){dependencies.push(config)}else{dependencies.push(self.getService(name))}})}return dependencies}}function Controller(template,dom,handler){var htmlElement;var handlers={};this.template="";this.scope={};this.handler=handler.add;this.setHtmlElement=function(element){htmlElement=element};this.getHtmlElement=function(){return htmlElement};this.show=function(){if(htmlElement.style.display==="none"){htmlElement.style.display="";this.trigger("show")}};this.hide=function(){if(htmlElement.style.display!=="none"){htmlElement.style.display="none";this.trigger("hide")}};this.render=function(){this.setHtmlElement(dom.makeElement(template.fetch(this.template,this.scope)))};this.on=function(event,handler){handlers[event]=handler};this.off=function(event){delete handlers[event]};this.trigger=function(event){handlers[event]&&handlers[event]()}}var JSFrame=window.JSFrame=new Core;JSFrame.service("cookieStorage",function(){var prefix="JSFrame.";this.get=function(name){name=prefix+name;var regex=new RegExp("(?:^|; )"+name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)");var matches=document.cookie.match(regex);return matches?JSON.parse(decodeURIComponent(matches[1])):undefined};this.set=function(name,data,opts){name=prefix+name;opts=opts||{};var expires=opts.expires;if(typeof expires==="number"&&expires){var d=new Date;d.setTime(d.getTime()+expires*1e3);expires=opts.expires=d}if(expires&&expires.toUTCString){opts.expires=expires.toUTCString()}var value=encodeURIComponent(JSON.stringify(data));var updatedCookie=name+"="+value;for(var propName in opts){updatedCookie+="; "+propName;var propValue=opts[propName];if(propValue!==true){updatedCookie+="="+propValue}}document.cookie=updatedCookie};this.remove=function(name){this.set(name,null,{expires:"Thu, 01 Jan 1970 00:00:01 GMT",path:"/"})}});JSFrame.service("sessionStorage",function(){var prefix="JSFrame.";this.get=function(name){var data=window.sessionStorage.getItem(prefix+name);return data?JSON.parse(data):undefined};this.set=function(name,data){window.sessionStorage.setItem(prefix+name,JSON.stringify(data))};this.remove=function(name){window.sessionStorage.removeItem(prefix+name)}});JSFrame.service("localStorage",function(){var prefix="JSFrame.";this.get=function(name){var data=window.localStorage.getItem(prefix+name);return data?JSON.parse(data):undefined};this.set=function(name,data){window.localStorage.setItem(prefix+name,JSON.stringify(data))};this.remove=function(name){window.localStorage.removeItem(prefix+name)}});JSFrame.service("memoryStorage",function(){var prefix="JSFrame.";var storage={};this.get=function(name){return storage[prefix+name]};this.set=function(name,data){storage[prefix+name]=data};this.remove=function(name){delete storage[prefix+name]}});(function(){var self=this;self.checkStorageAccess=function(){try{if(!window.localStorage||!window.sessionStorage)throw"exception";localStorage.setItem("storage_test",1);localStorage.removeItem("storage_test")}catch(e){self.createCookieStorage()}};self.createCookieStorage=function(){var Storage=function(type){function createCookie(name,value,days){var date,expires;if(days){date=new Date;date.setTime(date.getTime()+days*24*60*60*1e3);expires="; expires="+date.toGMTString()}else{expires=""}document.cookie=name+"="+value+expires+"; path=/"}function readCookie(name){var nameEQ=name+"=",ca=document.cookie.split(";"),i,c;for(i=0;i<ca.length;i++){c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null}function setData(data){data=encodeURIComponent(JSON.stringify(data));if(type=="session"){createCookie(getSessionName(),data,365)}else{createCookie("localStorage",data,365)}}function clearData(){if(type=="session"){createCookie(getSessionName(),"",365)}else{createCookie("localStorage","",365)}}function getData(){var data=type=="session"?readCookie(getSessionName()):readCookie("localStorage");return data?JSON.parse(decodeURIComponent(data)):{}}function getSessionName(){if(!window.name){window.name=(new Date).getTime()}return"sessionStorage"+window.name}var data=getData();return{length:0,clear:function(){data={};this.length=0;clearData()},getItem:function(key){return data[key]===undefined?null:data[key]},key:function(i){var ctr=0;for(var k in data){if(ctr==i)return k;else ctr++}return null},removeItem:function(key){delete data[key];this.length--;setData(data)},setItem:function(key,value){data[key]=value+"";this.length++;setData(data)}}};var localStorage=new Storage("local");var sessionStorage=new Storage("session");window.localStorage=localStorage;window.sessionStorage=sessionStorage;if(typeof window.localStorage.prototype!=="undefined"){window.localStorage.prototype=localStorage;window.sessionStorage.prototype=sessionStorage}else if(typeof window.localStorage.__proto__!=="undefined"){window.localStorage.__proto__=localStorage;window.sessionStorage.__proto__=sessionStorage}};self.checkStorageAccess()})();JSFrame.service("router",function(storage){var onChangeCallback=function(){};this.go=function(name,params){storage.set("router.current",[name,params]);onChangeCallback(name,params)};this.is=function(name,params){var route=storage.get("router.current");if(!route){return false}if(name!==route[0]||params&&!route[1]){return false}if(params&&route[1]){for(var param in params){if(params[param]!=route[1][param]){return false}}}return true};this.getCurrent=function(){return storage.get("router.current")};this.getName=function(){var route=this.getCurrent();return route?route[0]:undefined};this.getParams=function(){var route=this.getCurrent();return route&&route[1]?route[1]:{}};this.onChange=function(callback){onChangeCallback=callback}},["memoryStorage"]);JSFrame.service("template",function(views,dom,localization,config,handler){var controllers=[];this.render=function(name,params,target){var element=dom.makeElement(this.fetch(name,params));dom.html(target,element);return element};this.fetch=function(name,params){params=params||{};if(!params.config){params.config=function(name){if("host".indexOf(name)!==-1){return JSFrame.windowProtocol+"//"+config[name]}return config[name]}}if(!params.controller){params.controller=controller}if(!params.translate){params.translate=localization.translate}if(!params.handler){params.handler=handler.make}var path=name.split(".");var view=views[path[0]];for(var i=1;i<path.length;i++){view=view[path[i]]}return _.template(view)(params)};this.initAll=function(){for(var i=0;i<controllers.length;i++){dom.replaceWith(dom.get("#controller-"+i),JSFrame.getController(controllers[i]).getHtmlElement())}};function controller(name){controllers.push(name);return'<span id="controller-'+(controllers.length-1)+'"></span>'}},["views","dom","localization","config","handler"]);JSFrame.service("dom",function(jscd){var parentElement=document.body;this.setParentElement=function(element){parentElement=element};this.get=function(selector,parent){parent=parent||parentElement;return parent.querySelector(selector)};this.getAll=function(selector,parent){parent=parent||parentElement;return parent.querySelectorAll(selector)};this.html=function(parent,elements){parent.innerHTML="";this.append(parent,elements)};this.append=function(parent,element){parent.appendChild(this.makeElement(element))};this.after=function(node,element){if(!node){return}if(node.nextSibling){node.parentNode.insertBefore(this.makeElement(element),node.nextSibling)}else{this.append(node.parentNode,this.makeElement(element))}};this.replaceWith=function(node,element){if(!node){return}this.after(node,element);this.remove(node)};this.remove=function(node){if(!node){return}node.parentNode.removeChild(node)};this.makeElement=function(html){if(typeof html==="string"){var e=document.createElement("div");e.innerHTML=html;while(e.firstChild){return e.firstChild}}return html};this.on=function(element,event,callback){element.addEventListener(event,callback)};this.loadCss=function(css,callback){var done=false;var style=document.createElement("link");style.setAttribute("type","text/css");style.setAttribute("rel","stylesheet");style.setAttribute("href",css);style.onload=function(){if(!done){done=true;callback&&callback()}};style.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){done=true;callback&&callback()}};document.head.appendChild(style);if(jscd.mobile&&!done){done=true;callback&&callback()}}},["jscd"]);JSFrame.service("localization",function(locales,settings,transport){this.translate=function(text,params){var language=settings.language.toLowerCase();if(locales[language]&&locales[language][text]){return locales[language][text].replace(/\{([a-zA-Z0-9_]+)\}/g,function(find,varName){return params[varName]})}else if(language!="ru"){transport.emit("client:log",{error:"Phrase is missing (localization)",language:language,text:text})}return text}},["locales","settings","socketIO"]);JSFrame.service("jscd",function(){var self=this;self.init=function(){var unknown="";var screenSize="";if(screen.width){width=screen.width?screen.width:"";height=screen.height?screen.height:"";screenSize+=""+width+" x "+height}var documentWidth=0;var documentHeight=0;if(typeof window.innerWidth==="number"){documentWidth=window.innerWidth;documentHeight=window.innerHeight}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){documentWidth=document.documentElement.clientWidth;documentHeight=document.documentElement.clientHeight}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){documentWidth=document.body.clientWidth;documentHeight=document.body.clientHeight}var nVer=navigator.appVersion;var nAgt=navigator.userAgent;var browser=navigator.appName;var version=""+parseFloat(navigator.appVersion);var majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;var oldMSIE=false;if((verOffset=nAgt.indexOf("Opera"))!=-1){browser="Opera";version=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf("Version"))!=-1){version=nAgt.substring(verOffset+8)}}else if((verOffset=nAgt.indexOf("MSIE"))!=-1){browser="Microsoft Internet Explorer";version=nAgt.substring(verOffset+5);oldMSIE=parseInt(version)<10}else if((verOffset=nAgt.indexOf("Chrome"))!=-1){browser="Chrome";version=nAgt.substring(verOffset+7)}else if((verOffset=nAgt.indexOf("Safari"))!=-1){browser="Safari";version=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf("Version"))!=-1){version=nAgt.substring(verOffset+8)}}else if((verOffset=nAgt.indexOf("Firefox"))!=-1){browser="Firefox";version=nAgt.substring(verOffset+8)}else if(nAgt.indexOf("Trident/")!=-1){browser="Microsoft Internet Explorer";version=nAgt.substring(nAgt.indexOf("rv:")+3)}else if((nameOffset=nAgt.lastIndexOf(" ")+1)<(verOffset=nAgt.lastIndexOf("/"))){browser=nAgt.substring(nameOffset,verOffset);version=nAgt.substring(verOffset+1);if(browser.toLowerCase()==browser.toUpperCase()){browser=navigator.appName}}if((ix=version.indexOf(";"))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(" "))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(")"))!=-1)version=version.substring(0,ix);majorVersion=parseInt(""+version,10);if(isNaN(majorVersion)){version=""+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10)}var mobile=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);var cookieEnabled=navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=document.cookie.indexOf("testcookie")!=-1?true:false}var os=unknown;var clientStrings=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"OpenBSD",r:/OpenBSD/},{s:"SunOS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"MacOS-X",r:/Mac OS X/},{s:"MacOS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"SearchBot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var id in clientStrings){var cs=clientStrings[id];if(cs.r.test(nAgt)){os=cs.s;break}}var osVersion=unknown;try{if(/Windows/.test(os)){osVersion=/Windows (.*)/.exec(os)[1];os="Windows"}switch(os){case"Mac OS X":osVersion=/Mac OS X (10[\.\_\d]+)/.exec(nAgt)[1];break;case"Android":osVersion=/Android ([\.\_\d]+)/.exec(nAgt)[1];break;case"iOS":osVersion=/OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);osVersion=osVersion[1]+"."+osVersion[2]+"."+(osVersion[3]|0);break}}catch(e){}var flashVersion="no check";if(typeof swfobject!="undefined"){var fv=swfobject.getFlashPlayerVersion();if(fv.major>0){flashVersion=fv.major+"."+fv.minor+" r"+fv.release}else{flashVersion=unknown}}self.screen=screenSize;self.width=documentWidth;self.height=documentHeight;self.browser=browser;self.browserVersion=version;self.mobile=mobile;self.os=os;self.osVersion=osVersion;self.cookies=cookieEnabled;self.flashVersion=flashVersion;self.oldMSIE=oldMSIE};self.init()});JSFrame.service("handler",function(){this.add=function(name,handler){JSFrame.handlers[name]=handler};this.make=function(name){return"JSFrame.handlers['"+name+"'](this, event)"}});JSFrame.handlers={};JSFrame.service("settings",function(localStorage,jscd,config){var self=this;var storageKey="settings";var params=localStorage.get(storageKey)||{};self.version="";self.debug=config.debug||false;self.sound="";self.button={appearance:"",position:"",layout:"",hide:false,no:false};self.block={appearance:"",position:""};self.text={offline:"",online:"",waiting:"",seller:"",complete:""};self.theme="";self.language="";self.text_disconnect_event="";self.support_email="";self.status="";self.position=params.position||getBlockPositionDefault();self.mute=params.mute||false;self.set=function(name,value){this[name]=value;if(["position","version","mute"].indexOf(name)!==-1){params[name]=value;localStorage.set(storageKey,params)}};function getBlockPositionDefault(){var widget=JSFrame.block;var widgetWidth=widget&&widget.style.width?parseInt(widget.style.width):302;var widgetHeight=widget&&widget.style.height?parseInt(widget.style.height):462;var left=Math.round((jscd.width-widgetWidth)/2);var top=Math.round((jscd.height-widgetHeight)/2);var positions={"top-left":"left: 10px; top: 10px;","top-center":"left: "+left+"px; top: 10px;","top-right":"right: 10px; top: 10px;","bottom-left":"left: 10px; bottom: 10px;","bottom-center":"left: "+left+"px; bottom: 10px;","bottom-right":"right: 10px; bottom: 10px;","left-top":"left: 10px; top: 10px;","left-center":"left: 10px; top: "+top+"px;","left-bottom":"left: 10px; bottom: 10px;","right-top":"right: 10px; top: 10px;","right-center":"right: 10px; top: "+top+"px;","right-bottom":"right: 10px; bottom: 10px;"};var pos=self.block.appearance+"-"+self.block.position;return positions[pos]||positions["right-bottom"]}},["localStorage","jscd","config"]);JSFrame.service("draggable",function(jscd){this.init=function(block,item,callback){var position={};var innerPosition={};var mouseDown=false;if(jscd.browser==="Opera"){block.style.position="absolute"}item.ondragstart=function(){return false};item.onselectstart=function(){return false};document.onmousemove=function(e){var evt=e||window.event;position.x=evt.clientX;position.y=evt.clientY;mouseDown&&elementMove()};document.onmouseup=function(){mouseDown=false};item.onmousedown=function(){mouseDown=true;innerPosition.x=position.x-block.offsetLeft;innerPosition.y=position.y-block.offsetTop};function elementMove(){var left=position.x-innerPosition.x;var top=position.y-innerPosition.y;if(left<0){left=0}if(top<0){top=0}block.style.left=left+"px";block.style.top=top+"px";callback({left:left,top:top})}}},["jscd"]);JSFrame.service("resizable",function(jscd,dom){var self=this;self.init=function(){window.addEventListener("orientationchange",self.resize);window.addEventListener("resize",self.resize)};self.resize=function(){jscd.init();var chat=JSFrame.getController("block").getHtmlElement();if(chat){chat.style.top=0;chat.style.left=0;chat.style.width=jscd.width-2+"px";chat.style.height=jscd.height-2+"px";dom.get(".sh_container_root").style.height="auto";dom.get(".sh_textarea_field").style.width="100%";dom.get("#sh_messages").style.height=jscd.height-155+"px"}}},["jscd","dom"]);JSFrame.service("chat",function(transport,sessionStorage,localStorage,router,settings,dom,config,template,event,audio,jscd,constants){var self=this;var isLoaded=false;self.online=false;self.hasQueue=false;self.isFinished=false;self.data={};self.historyId=0;self.mark=0;self.historyData=[];self.scripts={};self.userInfo={};self.skipQueueCloseEvent=false;self.operatorName="Operator";self.init=function(widgetId,token,userInfo,opts){if(userInfo){self.userInfo=userInfo}if(opts){for(var i in opts){switch(i){case"host":config.host=opts[i];config.node_host=config.node_host_prefix+opts[i];break}}}transport.connect(widgetId,token,userInfo);transport.on("connected",function(data){if(data){self.userInfo=data}if(!isLoaded){transport.emit("client:widget.get",{widget_id:widgetId})}event.trigger("connect");isLoaded=true});transport.on("disconnect",function(){if(self.data.status_id<constants.chatStatus.STATUS_FINISHED){var data={chat_id:self.data.chat_id,client:{client_id:0,name:"SERVICE MESSAGE",photo:config.system_img,user_type:2},client_id:0,delivered:0,message_id:0,timestamp:new Date,type_id:0,service:true,text:settings.text_disconnect_event.replace(/\{operator_name\}/g,self.operatorName)||"Connection error.",support_email:settings.support_email};event.trigger("messageReceived",data);audio.play()}});transport.on("main:user.data",function(data){if(data){self.userInfo=data}});transport.on("client:widget.init",function(data){self.online=data.online;event.trigger("changeStatus");self.hasQueue=data.queue;event.trigger("changeStatusQueue");for(var i in settings){if(data.settings[i]!==undefined){settings[i]=data.settings[i]}}if(opts){for(var i in opts){switch(i){case"side_appearance":settings.button.appearance=opts[i];break;case"side_position":settings.button.position=opts[i];break;case"header_layout":settings.button.layout=opts[i];break;case"hide_button":settings.button.hide=opts[i];break;case"side_block_appearance":settings.block.appearance=opts[i];break;case"side_block_position":settings.block.position=opts[i];break;case"header_online":settings.text.online=opts[i];break;case"header_offline":settings.text.offline=opts[i];break;case"text_seller":settings.text.seller=opts[i];break;case"text_waiting":settings.text.waiting=opts[i];break;case"text_client_complete":settings.text.complete=opts[i];break;case"theme":settings.theme=opts[i];break}}}if(jscd.mobile){settings.button.hide=true}dom.loadCss(JSFrame.windowProtocol+"//"+config.host+"/css/theme/"+settings.theme+".css",function(){dom.append(document.body,JSFrame.getController("button").getHtmlElement());var parentElement=JSFrame.getController("block").getHtmlElement();dom.append(document.body,parentElement);dom.setParentElement(parentElement);template.initAll();JSFrame.run();if(settings.status==="opened"){router.go("block",{action:"online"})}transport.emit("client:widget.scripts")})});transport.on("client:chat.online",function(online){self.online=online;event.trigger("changeStatus")});transport.on("client:chat.queue",function(hasQueue){self.hasQueue=hasQueue;event.trigger("changeStatusQueue")});transport.on("client:chat.init",function(data){var chatUpdatedFire=Object.keys(self.data).length==0;self.data=data;self.historyId=self.data.chat_id;self.isFinished=false;if(chatUpdatedFire){event.trigger("chatUpdated")}if(self.skipQueueCloseEvent){self.queueEvent(constants.eventDialog.SELECT_CHAT)}router.go("block",{action:"online"});if(data.open_type==="push"){audio.play()}});transport.on("client:chat.toprocess",function(data){JSFrame.getController("wait").hide();event.trigger("messageReceived",data);self.data.status_id=constants.chatStatus.STATUS_INPROCESS;audio.play();transport.emit("client:chat.delivered",data.message_id);event.trigger("changeStatus")});transport.on("client:chat.message",function(data){event.trigger("messageReceived",data);if(data.client.user_type==2){self.operatorName=data.client.name;audio.play();transport.emit("client:chat.delivered",data.message_id)}});transport.on("client:chat.form",function(data){event.trigger("formReceived",data)});transport.on("storage",function(data){for(var i=0;i<data.length;i++){if(data[i].name==="sessionid"){data[i].name+="-"+widgetId}if(data[i].type==="local"){localStorage.set(data[i].name,data[i].value)}else{sessionStorage.set(data[i].name,data[i].value)}}});transport.on("client:chat.push",function(data){self.start(data.operator,1)});transport.on("client:chat.deferred",function(){self.start()});transport.on("client:chat.finish",function(data){self.isFinished=true;self.skipQueueCloseEvent=false;data&&data.robot===1?router.go("button"):router.go("block",{action:"finish",noback:true})});transport.on("client:chat.close",function(){if(self.data.chat_id>0){router.go("button")}});transport.on("client:chat.history",function(data){if(data.chat_id){self.historyId=data.chat_id;self.historyData.unshift(data);event.trigger("historyAdded")}});transport.on("client:chat.attach",function(data){if(config.debug){console.info("Attache was saved: "+data)}});transport.on("client:chat.updateMessage",function(data){event.trigger("messageUpdated",data)});transport.on("client:widget.scripts",function(data){self.scripts=data;JSFrame.getService("scripts").run()})};self.start=function(operator,typeId,scriptId){transport.emit("client:chat.get",{operator:operator,type_id:typeId||0,name:localStorage.get("user-name"),script_id:scriptId})};self.autoRequest=function(scriptId){transport.emit("client:chat.auto",{script_id:scriptId})};self.refuseRequest=function(scriptId){transport.emit("client:chat.refuse",{script_id:scriptId})};self.send=function(text,formId){var data={text:text};if(formId){data.form=formId}transport.emit("client:chat.message",data)};self.preview=function(text){transport.emit("client:chat.preview",{text:text})};self.finish=function(decision,emailSave){transport.emit("client:chat.finish",{email:emailSave,mark:self.mark});self.mark=0;JSFrame.rating.setRating(0);self.queueEvent(constants.eventDialog.CLOSE_NOANSWER);event.trigger("chatClosed");self.data={}};self.history=function(){transport.emit("client:chat.history",{chat_id:self.historyId})};self.request=function(name,email,phone,comment){transport.emit("client:chat.request",{contacts:{name:name,email:email,phone:phone,comment:comment}})};self.queueEvent=function(event){transport.emit("client:chat.queueEvent",{name:localStorage.get("user-name"),event:event,chat_id:self.data.chat_id||""})};self.inviteOperator=function(){transport.emit("client:chat.inviteOperator")};self.log=function(data){transport.emit("client:log",data)}},["socketIO","sessionStorage","localStorage","router","settings","dom","config","template","event","audio","jscd","constants"]);JSFrame.service("event",function(){var self=this;var callbacks={};self.on=function(event,callback){if(!callbacks[event]){callbacks[event]=[]}callbacks[event].push(callback)};self.off=function(event){delete callbacks[event]};self.trigger=function(event,data){if(!callbacks[event]){return}for(var i=0;i<callbacks[event].length;i++){callbacks[event][i].call(window,data)}}});JSFrame.service("func",function(){var self=this;self.readableFileSize=function(size){var units=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];var i=0;while(size>=1024){size/=1024;++i}return size.toFixed(1)+" "+units[i]};self.makeTime=function(timestamp){timestamp=new Date(timestamp);var time=[];var hours=timestamp.getHours();time.push(hours<10?"0"+hours:hours);var minutes=timestamp.getMinutes();time.push(minutes<10?"0"+minutes:minutes);var seconds=timestamp.getSeconds();time.push(seconds<10?"0"+seconds:seconds);return time.join(":")};self.makeDate=function(timestamp){timestamp=new Date(timestamp);var date=[];var day=timestamp.getDate();date.push(day<10?"0"+day:day);var month=timestamp.getMonth()+1;date.push(month<10?"0"+month:month);date.push(timestamp.getFullYear());return date.join(".")};self.throttle=function(fn,timeout,ctx){var timer,args,needInvoke;return function(){args=arguments;needInvoke=true;ctx=ctx||this;timer||function(){if(needInvoke){fn.apply(ctx,args);needInvoke=false;timer=setTimeout(arguments.callee,timeout)}else{timer=null}}()}}});JSFrame.service("audio",function(settings,jscd,dom){var self=this;self.play=function(data){if(!settings.mute&&!jscd.oldMSIE){var audio=dom.get("#sh_container_audio");audio.currentTime=0;audio.play()}}},["settings","jscd","dom"]);JSFrame.service("scripts",function(settings,dom,sessionStorage,chat,router,template,config){var self=this;var timeout;var pageOpenTime=+new Date;var siteOpenTime=parseInt(sessionStorage.get("starttime"))||+new Date;self.run=function(){try{if(!("onhashchange"in window)){var oldHref=window.location.href;setInterval(function(){var newHref=window.location.href;if(oldHref!==newHref){oldHref=newHref;
self.init()}},100)}else if(window.addEventListener){window.addEventListener("hashchange",self.init,false)}else if(window.attachEvent){window.attachEvent("onhashchange",self.init)}self.init()}catch(e){if(settings.debug){console.warn(e)}}};self.init=function(){clearTimeout(timeout);if(!chat.online){return false}var startTimes={};for(var id in chat.scripts){var time=checkCondition(chat.scripts[id]);if(time!==-1){startTimes[id]=time}}var minId,minTime;for(var id in startTimes){if(!minTime||startTimes[id]<minTime){minId=id;minTime=startTimes[id]}}if(minId){timeout=setTimeout(function(){sessionStorage.set("lastcalltime",+new Date);renderPushRequest(chat.scripts[minId].request_text,null,minId)},minTime-new Date)}};function checkCondition(condition){var nextStart=-1;if(condition.url_pattern&&window.location.href.indexOf(condition.url_pattern)===-1){return nextStart}if(condition.balance_type==2&&chat.userInfo.balance<condition.balance){return nextStart}if(condition.balance_type==3&&chat.userInfo.balance>condition.balance){return nextStart}if(condition.demo_timeout>0&&!chat.userInfo.is_demo_game){return nextStart}if(condition.last_invite_timeout>0){var lastcalltime=sessionStorage.get("lastcalltime")||0;if(lastcalltime){var _nextStart=parseInt(lastcalltime)+parseInt(condition.last_invite_timeout)*6e4;nextStart=_nextStart>nextStart?_nextStart:nextStart}else{var _nextStart=+new Date;nextStart=_nextStart>nextStart?_nextStart:nextStart}}if(condition.visit_page_timeout>0){var _nextStart=pageOpenTime+parseInt(condition.visit_page_timeout)*1e3;nextStart=_nextStart>nextStart?_nextStart:nextStart}if(condition.visit_site_timeout>0){var _nextStart=siteOpenTime+parseInt(condition.visit_site_timeout)*1e3;nextStart=_nextStart>nextStart?_nextStart:nextStart}if(condition.after_auth_timeout>0&&chat.userInfo.auth_date){var _nextStart=+new Date(chat.userInfo.auth_date)+parseInt(condition.after_auth_timeout)*1e3;nextStart=_nextStart>nextStart?_nextStart:nextStart}if(condition.demo_timeout>0&&chat.userInfo.is_demo_game){var _nextStart=pageOpenTime+parseInt(condition.demo_timeout)*1e3;nextStart=_nextStart>nextStart?_nextStart:nextStart}if(nextStart===-1){nextStart=+new Date}return nextStart}function renderPushRequest(text,operator,scriptId){if(!dom.get("#rh-arrow",document.body)&&!router.is("block")){chat.autoRequest(scriptId);dom.append(document.body,template.fetch("push.block",{host:JSFrame.windowProtocol+"//"+config.host,text:text}));var element=dom.get("#rh-arrow",document.body);dom.get("#rh-choiceYes",element).onclick=function(){chat.start(operator,2,scriptId);dom.remove(element)};dom.get("#rh-choiceNo",element).onclick=function(){chat.refuseRequest(scriptId);dom.remove(element)};dom.get("#rh-choiceClose",element).onclick=function(){chat.refuseRequest(scriptId);dom.remove(element)}}}},["settings","dom","sessionStorage","chat","router","template","config"]);JSFrame.service("starsService",function(chat,settings){this.stars={init:function(el,data){data=!data?[{title:" ",description:settings.text.marksText,rating:1}]:data;(function init(){for(var i=0;i<data.length;i++){addRatingWidget(buildItems(data[i]),data[i])}})();function buildItems(data){var item=document.createElement("div");var html="";var title=data.title?data.title:"  ";html+=title?'<span class="c-item__title">'+title+"</span><br>":"";html+=data.description?'<p class="c-item__description">'+data.description+"</p>":"";html+='<ul class="c-rating"></ul>';item.classList.add("c-item");item.innerHTML=html;el.appendChild(item);return item}function addRatingWidget(item,data){var ratingElement=item.querySelector(".c-rating");var currentRating=data.rating;var maxRating=5;var callback=function(rating){chat.mark=rating};JSFrame.rating=JSFrame.rating(ratingElement,currentRating,maxRating,callback)}}}},["chat","settings"]);JSFrame.service("socketIO",function(sessionStorage,localStorage,config,jscd,settings){var self=this;var socket;var connected=false;self.connect=function(widget_id,token,user_info){var options=jscd.oldMSIE?{}:{transports:["websocket","polling"]};var transport=sessionStorage.get("transport");if(transport&&options.transports.length){options.transports.splice(options.transports.indexOf(transport),1);options.transports.unshift(transport)}options.onCreateTransport=function(name){transport=name};socket=io(JSFrame.windowProtocol+"//"+config.node_host,options);socket.on("connect",function(){if(settings.debug){console.info("ON:","connect")}if(!connected&&transport&&transport!=="websocket"){if(settings.debug){console.info("Set transport: "+transport)}sessionStorage.set("transport",transport)}connected=true;var connectionData={session_id:localStorage.get("sessionid-"+widget_id),widget_id:widget_id,current_page:window.location.href,navigator:jscd,new_visitor:!!sessionStorage.get("newvisitor"),user_info:user_info};if(typeof token==="string"){connectionData.token=token}else if(typeof token==="object"&&token!==null){connectionData.project_id=token.project_id;connectionData.user_id=token.user_id;connectionData.signature=token.signature}socket.send(connectionData);if(settings.debug){console.info("SEND:",connectionData)}});socket.on("main:error",function(data){if(settings.debug){console.warn("ERROR:",data)}})};self.uploaderInit=function(element){var uploader=new SocketIOFileUpload(socket);uploader.listenOnInput(element)};self.on=function(event,callback){socket.on(event,function(data){if(settings.debug){console.info("ON:",event,data)}callback(data)})};self.emit=function(event,data){if(settings.debug){console.info("EMIT:",event,data)}socket.emit(event,data)};self.disconnect=function(){socket.disconnect()}},["sessionStorage","localStorage","config","jscd","settings"]);JSFrame.controller("block",function(template,dom,handler,settings,draggable,resizable,router,jscd,chat,event,constants){var self=this;self.template="chat.block";self.scope.sound=settings.sound;self.scope.position=settings.position;self.scope.title=chat.online?settings.text.online:settings.text.offline;self.handler("block.hide",function(){router.go("button")});self.handler("block.close",function(){if(chat.data.chat_id>0){if(chat.data.status_id==constants.chatStatus.STATUS_DEFERRED){var buttonInvite=dom.get("#sh_button_invite_operator",self.getHtmlElement());var buttonClose=dom.get("#sh_button_close_chat",self.getHtmlElement());var menu=dom.get(".sh_footer_menu_list",self.getHtmlElement());var form=dom.get(".sh_textarea_answer",self.getHtmlElement());buttonInvite.style.display="none";buttonClose.style.display="none";menu.style.display="block";form.style.display="block";chat.finish();router.go("button")}else if(router.is("block",{action:"finish"})){chat.finish();router.go("button")}else{router.go("block",{action:"finish"})}}else{if(chat.hasQueue&&!chat.skipQueueCloseEvent){chat.queueEvent(constants.eventDialog.CLOSE)}router.go("button")}});self.on("ready",function(){var element=self.getHtmlElement();setTitle();event.on("changeStatus",setTitle);if(!jscd.oldMSIE){dom.get("#sh_container_audio",element).load()}if(jscd.mobile){resizable.init()}else{draggable.init(element,dom.get(".sh_title",element),function(position){settings.set("position","left: "+position.left+"px; "+"top: "+position.top+"px;")})}});self.on("show",function(){var element=dom.get("#rh-arrow",document.body);element&&dom.remove(element);if(jscd.mobile){resizable.resize()}});function setTitle(){var title=chat.online?settings.text.online:settings.text.offline;dom.get(".sh_title",self.getHtmlElement()).innerHTML=title}},["template","dom","handler","settings","draggable","resizable","router","jscd","chat","event","constants"]);JSFrame.controller("queue",function(router,dom,localStorage,chat,constants){var self=this;self.template="chat.queue";self.scope.name=localStorage.get("user-name");self.handler("block.open.online",function(){var name=dom.get("#cw-client-name-queue").value.trim();if(name.length>0){localStorage.set("user-name",name);chat.skipQueueCloseEvent=true;router.go("block",{action:"online"})}});self.handler("block.open.ticket",function(){chat.queueEvent(constants.eventDialog.SELECT_REQUEST);chat.skipQueueCloseEvent=true;router.go("block",{action:"offline"})});self.handler("block.open.email",function(){});self.on("show",function(){if(chat.hasQueue){chat.skipQueueCloseEvent=false;chat.queueEvent(constants.eventDialog.WAITING)}})},["router","dom","localStorage","chat","constants"]);JSFrame.controller("auth",function(router,dom,localStorage){var self=this;self.template="chat.auth";self.scope.name=localStorage.get("user-name");self.handler("block.dialog.start",function(){var name=dom.get("#cw-client-name").value.trim();if(name.length>0){localStorage.set("user-name",name);router.go("block",{action:"online"})}})},["router","dom","localStorage"]);JSFrame.controller("offline",function(chat,dom,router){var self=this;self.template="chat.offline";self.handler("block.offline.request",function(){var nameField=dom.get('[name="chat[offline][name]"]',self.getHtmlElement());var emailField=dom.get('[name="chat[offline][email]"]',self.getHtmlElement());var phoneField=dom.get('[name="chat[offline][phone]"]',self.getHtmlElement());var commentField=dom.get('[name="chat[offline][comment]"]',self.getHtmlElement());var name=nameField.value.trim();var email=emailField.value.trim();var phone=phoneField.value.trim();var comment=commentField.value.trim();if(!name.length){nameField.style.borderColor="#f00";return false}else{nameField.style.borderColor="#dadad9"}if(!email.length&&!phone.length||email.length&&!/.+\@.+/.test(email)||phone.length&&!/\d+/.test(phone)){emailField.style.borderColor="#f00";phoneField.style.borderColor="#f00";return false}else{emailField.style.borderColor="#dadad9";phoneField.style.borderColor="#dadad9"}if(!comment.length){commentField.style.borderColor="#f00";return false}else{commentField.style.borderColor="#dadad9"}chat.request(name,email,phone,comment);dom.get(".sh_offline_form",self.getHtmlElement()).style.display="none";dom.get(".sh_offline_done",self.getHtmlElement()).style.display="block";nameField.value="";emailField.value="";phoneField.value="";commentField.value=""});self.handler("block.offline.close",function(){router.go("button")});self.on("show",function(){dom.get(".sh_offline_done",self.getHtmlElement()).style.display="none";dom.get(".sh_offline_form",self.getHtmlElement()).style.display="block"})},["chat","dom","router"]);JSFrame.controller("online",function(dom,router,settings,sessionStorage,jscd,transport,chat,event,template,func,config,constants){var self=this;var preview=null;self.template="chat.online";self.scope.history="";self.scope.wait="";self.scope.value="";self.scope.smiles=["smile","upset","no_words","laughter","shock","wink","sleep","steep","anger","offense"];self.scope.mute=settings.mute?" sh_ic_off":"";self.scope.message=sessionStorage.get("block.online.message")||"";self.scope.messages=[];self.handler("block.online.mute",function(element){settings.set("mute",!settings.mute);if(settings.mute){element.className+=" sh_ic_off"}else{element.className=element.className.replace(/\s*sh\_ic\_off\s*/,"")}});self.handler("block.online.showSmiles",function(element){var menu=dom.get(".sh_smiles",element);if(menu.style.display==="none"){menu.style.display="block"}else{menu.style.display="none"}});self.handler("block.online.selectSmile",function(element){var smile=dom.get(".sh_smile_icon",element).getAttribute("data-name");dom.get(".sh_textarea_field").value+="(:"+smile+":)"});self.handler("block.online.finish",function(){router.go("block",{action:"finish"})});self.handler("block.online.inputMessage",function(element,event){if(event.keyCode===13){var value=element.value.trim();if(value.length>0&&chat.data.status_id===constants.chatStatus.STATUS_INPROCESS){preview=null;chat.send(value);element.value=""}}else{if(!preview){preview=func.throttle(function(){var value=element.value.trim();if(value.length>0){chat.preview(value)}},500)}preview()}sessionStorage.set("block.online.message",element.value)});self.handler("block.online.send",function(){if(chat.data.status_id!=constants.chatStatus.STATUS_INPROCESS){return}var element=dom.get(".sh_textarea_field",self.getHtmlElement());var value=element.value.trim();if(value.length>0){chat.send(value);element.value="";sessionStorage.set("block.online.message",element.value)}});self.handler("block.online.inviteOperator",function(){var buttonInvite=dom.get("#sh_button_invite_operator",self.getHtmlElement());var buttonClose=dom.get("#sh_button_close_chat",self.getHtmlElement());var menu=dom.get(".sh_footer_menu_list",self.getHtmlElement());var form=dom.get(".sh_textarea_answer",self.getHtmlElement());buttonInvite.style.display="none";buttonClose.style.display="none";menu.style.display="block";form.style.display="block";JSFrame.getController("wait").show();chat.inviteOperator()});self.handler("block.online.closeChat",function(){var buttonInvite=dom.get("#sh_button_invite_operator",self.getHtmlElement());var buttonClose=dom.get("#sh_button_close_chat",self.getHtmlElement());var menu=dom.get(".sh_footer_menu_list",self.getHtmlElement());var form=dom.get(".sh_textarea_answer",self.getHtmlElement());buttonInvite.style.display="none";buttonClose.style.display="none";menu.style.display="block";form.style.display="block";chat.finish();router.go("button")});self.on("ready",function(){if(!jscd.oldMSIE){transport.uploaderInit(dom.get(".sh_attach_file",self.getHtmlElement()))}if(router.is("block",{action:"online"})){JSFrame.getController("wait").show();chat.start()}});self.on("show",function(){if(!dom.get("#sh_messages-"+chat.data.chat_id)){JSFrame.getController("wait").show();chat.start()}});event.on("chatUpdated",function(){if(!dom.get("#sh_messages-"+chat.data.chat_id)){dom.append(dom.get("#sh_messages",self.getHtmlElement()),template.fetch("chat.messages_block",{chat_id:chat.data.chat_id}))}chat.data.messages.forEach(renderMessage);if(chat.data.status_id==constants.chatStatus.STATUS_DEFERRED){var buttonInvite=dom.get("#sh_button_invite_operator",self.getHtmlElement());var buttonClose=dom.get("#sh_button_close_chat",self.getHtmlElement());var menu=dom.get(".sh_footer_menu_list",self.getHtmlElement());var form=dom.get(".sh_textarea_answer",self.getHtmlElement());buttonInvite.style.display="block";buttonClose.style.display="block";menu.style.display="none";form.style.display="none";JSFrame.getController("wait").hide()}showAttachButton()});event.on("chatClosed",function(){var element=dom.get("#sh_messages-"+chat.data.chat_id);element&&dom.remove(element);showAttachButton()});event.on("messageReceived",renderMessage);event.on("messageUpdated",function(data){dom.replaceWith(dom.get("#sh_"+data.message_id),template.fetch("message.item",{message_id:data.message_id,text:data.text.nl2br().replace(/\(\:([a-z_]+)\:\)/g,function(find,smile){return template.fetch("message.smile",{name:smile})})}))});event.on("formReceived",function(data){dom.append(dom.get("#sh_messages",self.getHtmlElement()),template.fetch("message.block",{id:data.message_id,data_id:data.client.client_id,name:data.client.name,photo:JSFrame.windowProtocol+"//"+config.host+"/users/"+data.client.photo,time:func.makeTime(data.timestamp),nick_sel:data.client.user_type==2?" sh_mess_nick_sel":"",support_email:data.support_email||"",items:template.fetch("message.form",{html:data.form.html})}));var parent=dom.get("#cw-message-"+data.message_id);dom.get(".cw-form-submit",parent).onclick=function(){var form={};var elements=dom.getAll(".cw-form [name]",parent);for(var i=0;i<elements.length;i++){var name=elements[i].getAttribute("name");form[name]=elements[i].value}chat.send(form,data.form.form_id);dom.remove(parent)};var messagesBlock=dom.get("#sh_messages");messagesBlock.scrollTop=messagesBlock.scrollHeight});event.on("changeStatus",function(){showAttachButton()});function showAttachButton(){var buttonAttach=dom.get("#attach_button_block",self.getHtmlElement());buttonAttach.style.display=chat.data.status_id==constants.chatStatus.STATUS_INPROCESS?"block":"block"}function renderMessage(message){message.support_email=message.support_email||"";var parent=dom.get("#sh_messages-"+message.chat_id);var html=fetchMessage(message);var items=dom.getAll(".sh_message",parent);if(message.client.user_type==2){JSFrame.getController("wait").hide()}if(items.length&&items[items.length-1].getAttribute("data-id")==message.client.client_id){dom.append(dom.get(".sh_message_items",items[items.length-1]),html)}else{var photo=message.type_id==constants.messageType.AUTO_MESSAGE_WAIT?config.system_img:message.client.photo;dom.append(parent,template.fetch("message.block",{id:message.message_id,data_id:message.client.client_id,name:message.client.name,photo:JSFrame.windowProtocol+"//"+config.host+"/users/"+photo,time:func.makeTime(message.timestamp),nick_sel:message.client.user_type==2?" sh_mess_nick_sel":"",items:html,support_email:message.support_email}))}var messagesBlock=dom.get("#sh_messages");messagesBlock.scrollTop=messagesBlock.scrollHeight}function fetchMessage(data){if(data.type_id==7){var shortname=data.text.name||data.text.base;if(shortname&&shortname.length>18){shortname=shortname.substr(0,18)+"..."}return template.fetch("message.file",{message_id:data.message_id,shortname:shortname,filename:data.text.name,filesize:func.readableFileSize(data.text.size),basename:data.text.base,host:JSFrame.windowProtocol+"//"+config.host,dir:data.path?data.path.dir:"",node_host:JSFrame.windowProtocol+"//"+config.node_host})}return template.fetch("message.item",{message_id:data.message_id,text:data.text.nl2br().replace(/\(\:([a-z_]+)\:\)/g,function(find,smile){return template.fetch("message.smile",{name:smile})})})}},["dom","router","settings","sessionStorage","jscd","socketIO","chat","event","template","func","config","constants"]);JSFrame.controller("history",function(event,chat,dom,template,func,config,constants){var self=this;self.template="chat.history";self.handler("block.history.show",function(){self.hide();chat.history()});event.on("historyAdded",function(){chat.historyData.forEach(function(data){if(!dom.get("#sh_messages-"+data.chat_id)){dom.after(self.getHtmlElement(),template.fetch("chat.history_block",{chat_id:data.chat_id,date:func.makeDate(data.start_time)+" "+func.makeTime(data.start_time)}));data.messages.forEach(renderMessage)}});self.show()});event.on("chatClosed",function(){chat.historyData.forEach(function(data){var element=dom.get("#sh_messages-"+data.chat_id);element&&dom.remove(element)});chat.historyData=[]});function renderMessage(message){var parent=dom.get("#sh_messages-"+message.chat_id);var html=fetchMessage(message);var items=dom.getAll(".sh_message",parent);if(items.length&&items[items.length-1].getAttribute("data-id")==message.client.client_id){dom.append(dom.get(".sh_message_items",items[items.length-1]),html)}else{var photo=message.type_id==constants.messageType.AUTO_MESSAGE_WAIT?config.system_img:message.client.photo;dom.append(parent,template.fetch("message.block",{id:message.message_id,data_id:message.client.client_id,name:message.client.name,photo:JSFrame.windowProtocol+"//"+config.host+"/users/"+photo,time:func.makeTime(message.timestamp),nick_sel:message.client.user_type==2?" sh_mess_nick_sel":"",items:html,support_email:""}))}}function fetchMessage(data){if(data.type_id==7){var shortname=data.text.name;if(shortname.length>18){shortname=shortname.substr(0,18)+"..."}return template.fetch("message.file",{message_id:data.message_id,shortname:shortname,filename:data.text.name,filesize:func.readableFileSize(data.text.size),basename:data.text.base,host:JSFrame.windowProtocol+"//"+config.host,node_host:JSFrame.windowProtocol+"//"+config.node_host})}return template.fetch("message.item",{message_id:data.message_id,text:data.text.nl2br().replace(/\(\:([a-z_]+)\:\)/g,function(find,smile){return template.fetch("message.smile",{name:smile})})})}},["event","chat","dom","template","func","config","constants"]);JSFrame.controller("wait",function(settings){var self=this;self.template="chat.wait";self.scope.text_waiting=settings.text.waiting},["settings"]);JSFrame.controller("finish",function(router,dom,chat,starsService,settings){var self=this;self.template="chat.finish";self.validate=false;self.scope.marksText=settings.text.marks||"";self.handler("block.finish.back",function(){router.go("block",{action:"online"})});self.handler("block.finish.save",function(){var decision=0;var emailSaveField=dom.get('[name="chat[email]"]',self.getHtmlElement());var emailSave=emailSaveField.value.trim();chat.finish(decision,emailSave);router.go("button")});self.handler("block.finish.validate",function(el){var reg={"chat[email]":/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/};if(!reg[el.getAttribute("name")].test(el.value)){self.validate=false;el.style.border="2px solid red"}else{self.validate=true;el.style.border="1px solid #dadad9"}});self.on("ready",function(){dom.get(".sh_button_back",self.getHtmlElement()).style.display=router.getParams().noback?"none":"";starsService.stars.init(dom.get("#yh-widget-rating",self.getHtmlElement()),[{title:settings.text.marksText,rating:0}])});self.on("show",function(){dom.get(".sh_button_back",self.getHtmlElement()).style.display=router.getParams().noback?"none":"";dom.get('[name="chat[email]"]',self.getHtmlElement()).value=""})},["router","dom","chat","starsService","settings"]);JSFrame.controller("button",function(router,settings,template,dom,chat,event){var self=this;var showButtonTicket=chat.online&&settings.button.leftTicket===true;self.template=showButtonTicket?"button.ticket":"button.block";self.scope.side_appearance=settings.button.appearance;self.scope.side_position=settings.button.position;self.scope.style=settings.button.hide||settings.button.no?"display: none;":"visibility: visible;";self.openBlock=function(){var data={action:chat.hasQueue?"queue":"auth"};if(!chat.online){data.action="offline"}else if(chat.data.chat_id>0){if(chat.isFinished){data.action="finish";data.noback=true}else{data.action="online"}}self.trigger("open");router.go("block",data)};self.handler("block.open",self.openBlock);self.on("ready",function(){setTitle();event.on("changeStatus",setTitle)});self.on("show",function(){if(settings.button.hide&&!chat.data.chat_id||settings.button.no){self.hide()}});function getTitle(title){var suffix=settings.button.layout==="horizontal"?"_trans":"";if(settings.button.appearance!=="top"&&settings.button.appearance!=="bottom"){title=title.replace(/./g,function(char){return template.fetch("button.char",{suffix:suffix,"char":char})})}return title}function setTitle(){var title=chat.online?settings.text.online:settings.text.offline;dom.get(".sh_title_text",self.getHtmlElement()).innerHTML=getTitle(title);if(showButtonTicket===true){var titleTicket=settings.text.ticket;dom.get(".sh_title_request",self.getHtmlElement()).innerHTML=getTitle(titleTicket)}}},["router","settings","template","dom","chat","event"]);JSFrame.config("constants",{eventDialog:{WAITING:1,CLOSE:2,SELECT_REQUEST:3,SELECT_CHAT:4,CONNECTED:5,CLOSE_NOANSWER:6},chatStatus:{STATUS_DEFERRED:0,STATUS_PENDING:1,STATUS_INPROCESS:2,STATUS_FINISHED:3},messageType:{MESSAGE:0,PRIVATE:1,TOPIC:2,FORM:3,FINANCE_HISTORY:4,LOGIN_HISTORY:5,ROUND_HISTORY:6,ATTACH:7,USER_INFO:8,TAG:9,FORM_SEND:10,AUTO_MESSAGE_WAIT:11}});JSFrame.config("config",{debug:false,node_host:"node.yhelperinfo.net",host:"node.yhelperinfo.net",node_host_prefix:"",system_img:"system_chat.png"});JSFrame.config("locales",{en:{", ,      ?":"Please tell us how should we address you?","  ":"Visitors on the website"," ":"Your name"," ":"Start the dialogue"," ":"Finish the dialogue","   ":"Open in a new window","":"Collapse"," ":"The dialogue is over","  ?":"Is your problem solved?",",  ":"Yes, the problem is solved",",   ":"No, the problem is not solved","     ":"Please leave us your contact information","":"Email","":"Phone","":"Comment"," ?":"Save the dialogue?","":"Back","  ":"Save and exit","":"History","   . ,      ,    !":"We are offline. Please leave us your contact information and your question, and we will get in touch with you later!","":"Introduce yourselves"," ":"Your question","":"Send","!":"Thank you!"," .":"The message is sent."," ":"Close the window","":"Sound","":"Finish"," ":"Send a file","":"Smile","  ...":"Enter your message...","":"Yes","":"No","!<br>        ,       .          .  ,    ":"Hello!<br>Currently, we are receiving a large number of requests, so it may take us time to reply you. We apologize for the inconvenience and hope for your understanding. Please note that you can always"," ":"Submit your request"," ":"Write an email","    ,     ":"If you prefer using chat to connect with operator please specify you name below"," ...":"Your name..."," ":"and press"," ":"Invite operator","":"Close"},tr:{", ,      ?":"Ltfen size nasl hitap etmemiz gerektiini belirtin.","  ":"Web sitesindeki ziyaretiler"," ":"Adnz"," ":"Diyalou balat"," ":"Diyalou bitir","   ":"Yeni pencerede a","":"Klt"," ":"Diyalog sona erdi","  ?":"Sorununuz zld m?",",  ":"Evet, sorunum zld",",   ":"Hayr, sorunum zlmedi","     ":"Ltfen bize iletiim bilgilerinizi brakn","":"E-posta","":"Telefon","":"Yorum"," ?":"Diyalou kaydetmek ister misiniz?","":"Geri git","  ":"Kaydet ve k","":"Gemi","   . ,      ,    !":"u an offline durumdayz. Ltfen bize iletiim bilgilerinizi brakn. Size daha sonra dn yapacaz!","":"Kendinizi tantn"," ":"Sorunuz","":"Gnder","!":"Teekkrler!"," .":"Mesaj gnderildi."," ":"Pencereyi kapat","":"Ses","":"Bitir"," ":"Dosya gnder","":"Glmse","  ...":"Mesajnz girin...","":"Evet","":"Hayr","!<br>        ,       .          .  ,    ":"Merhaba!<br>u anda ok fazla talep ile ilgilendiimizden tr yant vermemiz biraz zaman alacaktr. Zorluk iin zr diler, anlaynz iin teekkr ederiz. Aadakileri daima gerekletirebilirsiniz"," ":"Talep gnderme"," ":"E-posta gnderme","    ,     ":"Mesajlamay tercih ediyorsanz, ltfen aadaki bilgileri girerek bir operatre balann"," ...":"Ad..."," ":"Ve tklayn"," ":"Operatr davet edin","":"Kapat"},it:{", ,      ?":"Per favore ci indichi come dovremmo indirizzarci verso di lei?","  ":"Visitatori nel sito web"," ":"Suo nome"," ":"Inizio del dialogo"," ":"Fine del dialogo","   ":"Aprire in una nuova finestra","":"Restringere"," ":"Il dialogo  finito","  ?":"Il suo problema  stato risolto?",",  ":"Si, il problema  stato risolto",",   ":"No, il problema  stato risolto","     ":"La preghiamo di lasciarci le sue informazioni di contatto ","":"Email","":"Telefono","":"Commento"," ?":"Salvare il dialogo?","":"Indietro","  ":"Salvare ed uscire","":"Cronologia","   . ,      ,    !":"Non siamo in linea. La preghiamo di lasciarci le sue informazioni di contatto e la sua domanda, e la contatteremo in seguito!","":"Si presenti"," ":"La sua domanda","":"Inviare","!":"Grazie!"," .":"Il messaggio"," ":"Chiudere la finestra","":"Suono","":"Terminare"," ":"Inviare un file","":"Faccina","  ...":"Inserisca il suo messaggio","":"Si","":"No","!<br>        ,       .          .  ,    ":"Ciao!<br>Stiamo attulamente gestendo un alto numero di richieste, quindi ci vorr del tempo per rispondere. Ci scusiamo per l'inconveniente e ti ringraziamo per la comprensione. Nota che puoi sempre"," ":"Inviare una richiesta"," ":"Inviare un'e-mail","    ,     ":"Se preferiresti comunicare tramite chat, ti preghiamo di seguire la seguente procedura per collegarti con un operatore"," ...":"Nome..."," ":"E cliccare"," ":"Invita un operatore","":"Chiudi"},uk:{", ,      ?":" ,  ,      ?","  ":"  "," ":" '"," ":" "," ":" ","   ":"   ","":""," ":" ","  ?":"  ?",",  ":",  ",",   ":",   ","     ":"-,    i i  '","":"Email","":"","":""," ?":" ?","":"","  ":"  ","":"","   . ,      ,    !":"   i.  ,        ,   '   !","":""," ":" ","":"","!":"!"," .":" "," ":" ","":"","":""," ":" ","":"","  ...":"   ...","":"","":"","!<br>        ,       .          .  ,    ":"! <br>         ,       .         .  ,  ,    "," ":" "," ":" ",
"    ,     ":"    ,  '   "," ...":" '..."," ":" "," ":" ","":""},cn:{", ,      ?":"","  ":""," ":""," ":""," ":"","   ":"","":""," ":"","  ?":"",",  ":"",",   ":"","     ":"","":"","":"","":""," ?":"","":"","  ":"","":"","   . ,      ,    !":"","":""," ":"","":"","!":""," .":""," ":"","":"","":""," ":"","":"","  ...":"...","":"","":"","!<br>        ,       .          .  ,    ":"<br> "," ":""," ":"","    ,     ":""," ...":"..."," ":""," ":"","":""},de:{", ,      ?":"Sagen Sie uns, wie wir Sie erreichen knnen.","  ":"Die Besucherzahl auf der Website"," ":"Name"," ":"Chat starten"," ":"Chat beenden","   ":"Im neuen Fenster ffnen","":"Minimieren"," ":"Chat ist beendet","  ?":"Ist Ihr Problem gelst worden?",",  ":"Ja, mein Problem wurde behoben.",",   ":"Nein, mein Problem wurde nicht gelst","     ":"Bitte hinterlassen Sie Ihre Kontaktdaten, damit wir mit Ihnen in Kontakt treten knnen","":"E-Mail","":"Telefon","":"Kommentare"," ?":"Chat speichern?","":"Zurck","  ":"Speichern und beenden","":"Chronik","   . ,      ,    !":"Wir sind derzeit noch nicht online. Bitte hinterlassen Sie Ihre Kontaktdaten und Ihre Fragen und wir werden uns mit Ihnen in Verbindung setzen.","":"Sagen Sie uns, wer Sie sind"," ":"Ihre Fragen oder Beschwerden","":"Senden","!":"Danke!"," .":"Nachricht senden"," ":"Fenster schlieen","":"Ton","":"Chat beenden"," ":"Datei hochladen","":"Smiley","  ...":"Geben Sie den Nachrichten Text hier ein...","":"Ja","":"Nein","!<br>        ,       .          .  ,    ":"Hallo!<br>Wir sind zur Zeit mit einer groen Anzahl von Anrufen beschftigt, so dass es einige Zeit dauern kann diese zu beantworten. Wir entschuldigen uns fr die Unannehmlichkeiten und bedanken uns fr Ihr Verstndnis. Beachten Sie, dass wir immer fr Sie da sind"," ":"Hinterlassen Sie eine Nachricht"," ":"Senden Sie eine e-mail","    ,     ":"Wenn sie es vorziehen zu chatten, dann geben Sie zum Herstellen einer Verbindung den Anwender an"," ...":"Name"," ":"und klicken Sie"," ":"Anwender einladen","":"Schlieen"},no:{", ,      ?":"Kunne du si hvordan skal vi henvise oss til deg?","  ":"Antall beskende p nettsiden"," ":"Ditt navn"," ":"Begyn dialog"," ":"Avslutt dialog","   ":"pne p et nytt vindu","":"Skjul vindu"," ":"Dialog sluttet","  ?":"Har problemmet ditt blitt lst?",",  ":"Ja, problemet er lst",",   ":"Nei, problemet er ikke lst","     ":"Vennligst, legg til opplysninger for  kontakte deg","":"E-post","":"Telefon","":"Kommentarer"," ?":"Lagre dialog?","":"Tilbake","  ":"Lagre og avslutt","":"Historie","   . ,      ,    !":"Vi er offline. Vennligst, legg til dine kontakter og din foresprsel, og vi skal kontakte deg!","":"Introduser deg selv"," ":"Ditt sprsml","":"Sende","!":"Takk!"," .":"Meldingen ble sendt"," ":"Lukke vindu","":"Lyd","":"Avlsutt"," ":"Sende filen","":"Smile","  ...":"Skriv melding","":"Ja","":"Nei","!<br>        ,       .          .  ,    ":"Hei!<br>Vi er overveldet av sprsml n, derfor  kan det ta tid for  svare p sprsmlet ditt. Vi beklager disse problemene og hper p forstelsen din. Legg merke til at du alltid kan"," ":"Legg til ordre"," ":"Skriv brev","    ,     ":"Hvis det er bedre for deg  bruke chat for  kontake operatr, skriv det"," ...":"Ditt navn"," ":"og trykk"," ":"Inviter operatr","":"Lukke"," ":"Online hjelp"," ":"Legg til melding"," ":"Chat ble sluttet"}});JSFrame.config("views",{button:{block:'<div id="sh_button" class="shc sh_btn sh_btn_<%= side_appearance %> sh_btn_<%= side_appearance %>_<%= side_position %>" style="<%= style %>" onclick="<%= handler(\'block.open\') %>">\n    <div class="shc sh_logo">\n        <div class="shc sh_logo_cell">\n            <img rel="logo" class="shc sh_logo_btn" src="<%= config(\'host\') %>/images/logo.png">\n        </div>\n    </div>\n    <div rel="title" class="shc sh_title_text"></div>\n    <div class="shc sh_block_counter" title="<%= translate("  ") %>">\n        <span rel="counter">0</span>\n    </div>\n</div>',"char":'<div class="shc sh_btn_char<%= suffix %>"><%= char %></div>',ticket:'<div id="sh_button" class="shc sh_btn sh_btn_<%= side_appearance %> sh_btn_<%= side_appearance %>_<%= side_position %>" style="<%= style %>">\n    <div class="sh_chat_button_block" onclick="<%= handler(\'block.open\') %>">\n        <div class="shc sh_logo">\n            <div class="shc sh_logo_cell">\n                <img rel="logo" class="shc sh_logo_btn" src="<%= config(\'host\') %>/images/logo.png">\n            </div>\n        </div>\n        <div rel="title" class="shc sh_title_text"></div>\n        <div class="shc sh_block_counter" title="<%= translate("  ") %>">\n            <span rel="counter">0</span>\n        </div>\n    </div>\n\n    <div class="sh_ticket_button_block">\n        <div rel="title_request" class="shc sh_title_request" onclick="<%= handler(\'block.open.ticket\') %>"></div>\n    </div>\n</div>'},chat:{auth:'<div class="shc sh_online_box">\n    <div class="shc sh_form" rel="form">\n        <div class="shc sh_form_step sh_form_step_act" id="cw-dialog-question" rel="step">\n            <%= translate(", ,      ?") %>\n        </div>\n\n        <div class="sh_clear"></div>\n\n        <div class="shc sh_form_description" rel="description"></div>\n        \n        <div class="shc sh_form_fields" rel="fields">\n            <div class="shc sh_form_field sh_form_field_text" rel="field">\n                <input type="text" title="<%= translate(" ") %>" placeholder="<%= translate(" ") %>" value="<%= name %>" class="shc sh_input" id="cw-client-name">\n            </div>\n        </div>\n\n        <div class="shc sh_button" rel="form_button" onclick="<%= handler(\'block.dialog.start\') %>"><%= translate(" ") %></div>\n\n        <div class="shc sh_form_result" rel="apidescription"></div>\n    </div>\n</div>',block:'<div class="shc sh_chat" style="height: 460px; width: 300px; <%= position %>">\n    <div class="shc sh_header" rel="header">\n        <div class="shc sh_top_buttons">\n            <div rel="close" class="shc sh_hico sh_hico_close" title="<%= translate(" ") %>"\n                 onclick="<%= handler(\'block.close\') %>"></div>\n            <!--<div rel="popup" class="shc sh_hico sh_hico_popup" title="<%= translate("   ") %>"></div>-->\n            <div rel="hide" class="shc sh_hico sh_hico_hide" title="<%= translate("") %>"\n                 onclick="<%= handler(\'block.hide\') %>"></div>\n        </div>\n\n        <div class="shc sh_header_info">\n            <div class="shc sh_header_logo">\n                <div class="shc sh_header_logo_cell">\n                    <img rel="logo" class="sh_chat_logo" src="<%= config("host") %>/images/logo.png">\n                </div>\n            </div>\n\n            <div class="shc sh_title" rel="title"><%= title %></div>\n        </div>\n    </div>\n\n    <div class="sh_container_root shc sh_scrollbar" rel="scrollbar" style="height: 388px;">\n        <div id="sh_container" class="shc sh_container">\n            <%= controller(\'queue\') %>\n            <%= controller(\'auth\') %>\n            <%= controller(\'offline\') %>\n            <%= controller(\'online\') %>\n            <%= controller(\'finish\') %>\n        </div>\n    </div>\n\n    <div rel="copyright" class="shc sh_copyright">\n        <!--<div rel="resize" class="shc sh_resize"></div>-->\n    </div>\n\n    <audio id="sh_container_audio">\n        <source src="<%= config("host") %>/sounds/<%= sound %>.wav" type="audio/wav">\n        <source src="<%= config("host") %>/sounds/<%= sound %>.ogg" type="audio/ogg">\n        <source src="<%= config("host") %>/sounds/<%= sound %>.mp3" type="audio/mpeg">\n    </audio>\n</div>',finish:'<div class="shc sh_chat_end" rel="online_complate">\n    <!--<div class="shc sh_chat_title"><%= translate(" ") %></div>-->\n    <div id="yh-widget-rating"></div>\n\n    <div class="sh_clear"></div><br><br><br><br>\n    <div class="shc">\n        <div class="shc sh_chat_question"><%= translate(" ?") %></div>\n        <div class="shc sh_chat_fields">\n            <div class="shc sh_form_field">\n                <input rel="exit_email" class="shc sh_input" type="text" oninput="<%= handler(\'block.finish.validate\') %>" placeholder="<%= translate(\'\') %>" name="chat[email]">\n            </div>\n        </div>\n    </div>\n    <div class="shc sh_button_field">\n        <div rel="complate_back" class="shc sh_button sh_button_back" onclick="<%= handler(\'block.finish.back\') %>"><%= translate("") %></div>\n        <div rel="complate_save" class="shc sh_button sh_button_save" onclick="<%= handler(\'block.finish.save\') %>"><%= translate("  ") %></div>\n    </div>\n</div>',history:'<div class="shc sh_history_btn" rel="history" onclick="<%= handler(\'block.history.show\') %>"><%= translate("") %> </div>',history_block:'<div id="sh_messages-<%= chat_id %>" style="padding: 10px 0; background: #e7e7e7;">\n    <div style="text-align: center; font-weight: bold; margin-top: 10px;"><%= date %></div>\n</div>',messages_block:'<div id="sh_messages-<%= chat_id %>"></div>',offline:'<div class="shc sh_offline">\n    <div rel="form" class="shc sh_form sh_offline_form" data-id="sh_form_" data-type="">\n        <div rel="step" class="shc sh_form_step sh_form_step_act">\n            <span style="display: none;">1.</span>\n        </div>\n\n        <div class="sh_clear"></div>\n\n        <div rel="description" class="shc sh_form_description">\n            <%= translate("   . ,      ,    !") %>\n        </div>\n\n        <div rel="fields" class="shc sh_form_fields">\n            <div rel="field" class="shc sh_form_field sh_form_field_text">\n                <input type="text" class="shc sh_input" placeholder="<%= translate("") %>" title="<%= translate("") %>" name="chat[offline][name]">\n            </div>\n\n            <div rel="field" class="shc sh_form_field sh_form_field_text">\n                <input type="text" class="shc sh_input" placeholder="<%= translate("") %>" title="<%= translate("") %>" name="chat[offline][email]">\n            </div>\n\n            <div rel="field" class="shc sh_form_field sh_form_field_text">\n                <input type="text" class="shc sh_input" placeholder="<%= translate("") %>" title="<%= translate("") %>" name="chat[offline][phone]">\n            </div>\n\n            <div rel="field" class="shc sh_form_field_textarea">\n                <textarea class="shc sh_textarea" placeholder="<%= translate(" ") %>" title="<%= translate(" ") %>" name="chat[offline][comment]"></textarea>\n            </div>\n        </div>\n\n        <div rel="form_button" class="shc sh_button sh_button_submit" onclick="<%= handler(\'block.offline.request\') %>"><%= translate("") %></div>\n\n        <div rel="apidescription" class="shc sh_form_result"></div>\n    </div>\n    \n    <div class="shc sh_offline_done sh_hide">\n        <div class="shc sh_letter_img"></div>\n        <div class="shc sh_successfully"><%= translate("!") %></div>\n        <div class="shc sh_message_sent"><%= translate(" .") %></div>\n        <div rel="close" class="shc sh_button sh_button_close" onclick="<%= handler(\'block.offline.close\') %>"><%= translate(" ") %></div>\n    </div>\n</div>',online:'<div rel="online" class="shc sh_online_box">\n    <div rel="scrollbar" class="shc sh_messages sh_scrollbar" id="sh_messages" style="height: 299px;">\n        <%= controller(\'history\') %>\n        <%= controller(\'wait\') %>\n    </div>\n\n    <div rel="footer" class="shc sh_footer">\n        <div id="sh_button_invite_operator" class="shc sh_button" rel="form_button" onclick="<%= handler(\'block.online.inviteOperator\') %>" style="margin-top: 0; display: none;"><%= translate(" ") %></div>\n        <div id="sh_button_close_chat" class="shc sh_button" rel="form_button" onclick="<%= handler(\'block.online.closeChat\') %>" style="margin-top: 2px; display: none;"><%= translate("") %></div>\n\n        <div class="shc sh_footer_menu_list">\n            <div title="<%= translate("") %>" rel="sound" class="shc sh_footer_menu<%= mute %>" onclick="<%= handler(\'block.online.mute\') %>">\n                <div class="shc sh_ic sh_ic_sound"></div>\n            </div>\n\n            <div rel="complate" class="shc sh_button sh_button_send sh_button_back sh_button_gray_complete" onclick="<%= handler(\'block.online.send\') %>"><%= translate("") %></div>\n            <div rel="complate" class="shc sh_button sh_button_back sh_button_gray_complete" onclick="<%= handler(\'block.online.finish\') %>"><%= translate("") %></div>\n\n            <div title="<%= translate(" ") %>" rel="attach" class="shc sh_footer_menu" id="attach_button_block" style="display: none; position: relative;">\n                <div class="shc sh_ic sh_ic_attach"></div>\n                <div style="position: absolute; left: 0px; top: 0px; overflow: hidden; z-index: 10; width: 28px; height: 30px;">\n                    <input type="file" class="sh_attach_file" name="file" style="width: 28px; height: 30px; position: absolute; left: 0px; top: 0px; opacity: 0; cursor: pointer;">\n                </div>\n            </div>\n\n            <div title="<%= translate("") %>" rel="smiles" class="shc sh_footer_menu" onclick="<%= handler(\'block.online.showSmiles\') %>">\n                <div class="shc sh_ic sh_ic_smiles"></div>\n                <div class="shc sh_smiles" style="display: none;">\n                    <div class="shc sh_point"></div>\n                    <% _.each(smiles, function (value) { %>\n                    <div class="shc sh_smile_menu" onclick="<%= handler(\'block.online.selectSmile\') %>">\n                        <div class="shc sh_smile sh_smile_icon" rel="smile" data-name="<%= value %>"></div>\n                    </div>\n                    <% }); %>\n                </div>\n            </div>\n        </div>\n\n        <div rel="answer_form" class="shc sh_textarea_answer">\n            <textarea name="text" placeholder="<%= translate("  ...") %>" class="shc sh_textarea_field" style="width: 296px;" onkeyup="<%= handler(\'block.online.inputMessage\') %>"><%= message %></textarea>\n            <div title="<%= translate("") %>" rel="enter" class="shc sh_enter_ico" onclick="<%= handler(\'block.online.send\') %>"></div>\n        </div>\n    </div>\n</div>',queue:'<div class="shc sh_form" rel="form" style="padding: 8px; overflow: hidden;">\n    <div class="shc sh_chat_question" rel="step" style="text-align: center; margin-top: 0;">\n        <%= translate("!<br>        ,       .          .  ,    ") %>\n        <div class="shc sh_button" rel="form_button" onclick="<%= handler(\'block.open.ticket\') %>"><%= translate(" ") %></div>\n    </div>\n    <div class="sh_clear"></div>\n    <!--<div class="shc sh_chat_decision">\n        <div class="shc sh_button" rel="form_button" onclick="<%= handler(\'block.open.email\') %>"><%= translate(" ") %></div>\n    </div>-->\n    <div class="shc sh_chat_question" rel="step" style="text-align: center; margin-top: 0;">\n        <%= translate("    ,     ") %>\n        <div class="shc sh_form_field sh_form_field_text" rel="field" style="margin-top: 8px;">\n            <input type="text" placeholder="<%= translate(" ...") %>" value="<%= name %>" class="shc sh_input" id="cw-client-name-queue">\n        </div>\n        <%= translate(" ") %>\n        <div class="shc sh_button" rel="form_button" onclick="<%= handler(\'block.open.online\') %>"><%= translate(" ") %></div>\n    </div>\n</div>',wait:'<div class="sh_wait_connection" rel="wait"><%= text_waiting %></div>'},message:{block:'<div class="shc sh_message" id="cw-message-<%= id %>" data-id="<%= data_id %>">\n    <div class="shc sh_photo" style="height: auto;">\n        <img src="<%= photo %>" class="sh_avatar" style="height: auto;">\n    </div>\n\n    <div class="shc sh_mess_content">\n        <div class="shc sh_mess_details">\n            <div class="shc sh_mess_time"><%= time %></div>\n            <div class="shc sh_mess_nick<%= nick_sel %>"><%= name %></div>\n        </div>\n        \n        <div rel="text" class="shc sh_message_items"><%= items %></div>\n\n        <div><a href="mailto:<%= support_email %>?subject=Ticket to support"><%= support_email %></a></div>\n    </div>\n    \n    <div class="shc sh_clear"></div>\n</div>',file:'<div class="sh_file sh_file_icon sh_file_icon_file" style="clear: both;">\n    <a href="<%= host %>/chat/attach/<%= message_id %>-<%= basename %>" target="_blank" title="<%= filename %>"><%= shortname %> (<%= filesize %>)</a>\n</div>',form:'<div class="cw-form"><%= html %></div>\n<input class="cw-form-submit" type="button" value="<%= translate("") %>" style="background: #fff; border: 1px solid #d7d7d7;">',item:'<div class="shc sh_mess_text" id="sh_<%= message_id %>"><%= text %></div>',smile:'<div class="shc sh_smile sh_smile_img" data-name="<%= name %>"></div>'},push:{block:'<div id="rh-arrow" style="padding: 0px; display: block; bottom: auto; right: auto; right: 40px; top: 331px;" class="rh-reset rh-left">\n    <div class="placeholder">\n        <div id="rh-invitation" class="rh-arrowContainer" style="">\n            <div class="rh-text rh-reset">\n                <img alt="" class="rh-face rh-reset" src="<%= host %>/images/operator.png">\n                <div style="height: 8px;" class="rh-reset"></div>\n                <span id="rh-welcome" class="rh-reset"><%= text %></span>\n            </div>\n            <div id="rh-choice" class="rh-reset">\n                <a id="rh-choiceYes" class="rh-btn rh-reset"><%= translate("") %></a>\n                <a id="rh-choiceNo" class="rh-btn rh-reset"><%= translate("") %></a>\n            </div>\n            <div style="clear: both" class="rh-reset"></div>\n        </div>\n    </div>\n    <a id="rh-choiceClose" class="rh-close rh-reset"></a>\n    <div class="rh-reset rh-arrow_itself" style="top: 47.5px;"></div>\n</div>'}});if(!document.getElementsByClassName){document.getElementsByClassName=function(className){var found=[];var elements=document.getElementsByTagName("*");for(var i=0;i<elements.length;i++){var names=elements[i].className.split(" ");for(var j=0;j<names.length;j++){if(names[j]===className)found.push(elements[i])}}return found};if(typeof Element==="object"){Element.prototype.getElementsByClassName=document.getElementsByClassName}}if(!String.trim){String.trim=function(){return this.replace(/^\s+/g,"").replace(/\s+$/g,"")};String.prototype.trim=String.trim}if(!String.nl2br){String.nl2br=function(){return this.replace(/\n/g,"<br>\n")};String.prototype.nl2br=String.nl2br}var ChatWidget={init:function(widget_id,user_id,token,opts,user_info){JSFrame.getService("chat").init(widget_id,token,user_info,opts);JSFrame.getService("dom").loadCss(JSFrame.windowProtocol+"//"+JSFrame.getConfig("config").host+"/css/push.css");JSFrame.getService("dom").loadCss(JSFrame.windowProtocol+"//"+JSFrame.getConfig("config").host+"/css/rating.css")},show:function(){JSFrame.getController("button").openBlock()},hide:function(){JSFrame.getService("router").go("button")},on:JSFrame.getService("event").on,off:JSFrame.getService("event").off,trigger:JSFrame.getService("event").trigger};function YHelperChat(data){this.show=function(){ChatWidget.show()};this.hide=function(){ChatWidget.hide()};this.on=function(event,callback){ChatWidget.on(event,callback)};this.off=function(event){ChatWidget.off(event)};this.trigger=function(event){ChatWidget.trigger(event)};var token={project_id:data.project_id,user_id:data.user_id,signature:data.signature};ChatWidget.init(data.widget_id,data.user_id,token,data.settings,data.user_info)}window.ChatWidget=ChatWidget;window.YHelperChat=YHelperChat;if(window.YHelperChatData){new YHelperChat(window.YHelperChatData)}ratingInit();var _=this._}});